var webclient=function(e){function t(t){for(var r,u,i=t[0],c=t[1],l=t[2],f=0,p=[];f<i.length;f++)u=i[f],o[u]&&p.push(o[u][0]),o[u]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(s&&s(t);p.length;)p.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,i=1;i<n.length;i++){var c=n[i];0!==o[c]&&(r=!1)}r&&(a.splice(t--,1),e=u(u.s=n[0]))}return e}var r={},o={0:0},a=[];function u(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.e=function(e){var t=[],n=o[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise(function(t,r){n=o[e]=[t,r]});t.push(n[2]=r);var a,i=document.createElement("script");i.charset="utf-8",i.timeout=120,u.nc&&i.setAttribute("nonce",u.nc),i.src=function(e){return u.p+""+({}[e]||e)+".bundle.cc10469c7e28d867ee90.js"}(e),a=function(t){i.onerror=i.onload=null,clearTimeout(c);var n=o[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src,u=new Error("Loading chunk "+e+" failed.\n("+r+": "+a+")");u.type=r,u.request=a,n[1](u)}o[e]=void 0}};var c=setTimeout(function(){a({type:"timeout",target:i})},12e4);i.onerror=i.onload=a,document.head.appendChild(i)}return Promise.all(t)},u.m=e,u.c=r,u.d=function(e,t,n){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},u.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)u.d(n,r,function(t){return e[t]}.bind(null,r));return n},u.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="/Explorer/",u.oe=function(e){throw console.error(e),e};var i=window.webpackJsonpwebclient=window.webpackJsonpwebclient||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var s=c;return a.push([266,1]),n()}({264:function(e,t){},266:function(e,t,n){"use strict";n.r(t),n.d(t,"main",function(){return c}),n(267);var r=n(4),o=n(271),a=n(275).default,u=n(70).IntlProvider,i=n(760).loadLocale;function c(e){o.render(r.createElement(u,{loadLocale:i,locale:"it"},r.createElement(a,null)),e)}n(761),n(762)},267:function(e,t,n){n(268).polyfill(),n(269)},275:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(276);t.default=r.default},276:function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),a=n(277),u=n(279),i=n(115),c=n(710),l=n(722),s=n(723);n(735);var f=i.declareQueries({routes:c.routes}),p=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.popup=l.popup({closeButton:!1}),e.onMouseMove=u(function(t){if(e.props.routes.ready){var n=e.props.routes.value.reduce(function(n,r){var o=r.features[0].geometry.coordinates.reduce(function(n,o){var a=l.latLng(o[1],o[0]),u=e.map.latLngToContainerPoint(l.latLng(o[1],o[0])).distanceTo(e.map.latLngToContainerPoint(t.latlng));return u<n.distance?{distance:u,point:a,route:r}:n},{distance:1/0});return o.distance<n.distance?o:n},{distance:1/0});n.distance<50?e.popup.setLatLng(n.point).setContent(a.renderToString(o.createElement(s.default,{feature:n.route.features[0]}))).openOn(e.map):e.map.closePopup(e.popup)}},30),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),r(t,[{key:"initializeMap",value:function(){var e=this;this.map=l.map("map",{preferCanvas:!1}),this.tileLayer=l.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}",{id:"mapbox.streets",accessToken:"pk.eyJ1IjoiZnJhbmNlc2NvY2lvcmlhIiwiYSI6ImNqcThzMDJrejJ1bzgzeGxjZTZ2aXR0cHMifQ.qzCmhZEf3Ta1YHvAfli3bA"}),this.map.addLayer(this.tileLayer),navigator.geolocation.getCurrentPosition(function(t){e.map.setView(l.latLng(t.coords.latitude,t.coords.longitude),12)})}},{key:"updateMap",value:function(){var e=this;this.props.routes.ready&&(this.map.eachLayer(function(t){t!==e.tileLayer&&e.map.removeLayer(t)}),this.props.routes.value.map(function(t){var n=l.geoJSON(t,{style:function(e){return{color:e.properties.color}}});e.map.addLayer(n)})),this.map.on("mousemove",this.onMouseMove)}},{key:"componentDidMount",value:function(){this.initializeMap()}},{key:"componentDidUpdate",value:function(){this.updateMap()}},{key:"render",value:function(){return o.createElement("div",{id:"map"})}}]),t}();t.default=f(p)},710:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(711))},711:function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n(115);t.location=o.location;var a=n(712),u=n(714),i=n(715),c=n(721);t.currentView=o.Query({params:{},dependencies:{location:o.location},fetch:function(e){var t=e.location;return Promise.resolve(u.locationToView(t))}}),t.routes=o.Query({cacheStrategy:o.available,params:{},fetch:function(){return a.getRoutes().then(function(e){return e.map(function(e){return r({},e,{features:e.features.map(function(e){return r({},e,{properties:r({},e.properties,{color:i(e.properties.name),length:(c(e.geometry)/1e3).toFixed(1),elevationGain:Math.round(function(e){return e.reduce(function(t,n,r){var o=r>0?e[r-1][2]:void 0,a=n[2];return a&&o&&a>o?t+a-o:t},0)}(e.geometry.coordinates))})})})})})})}}),t.collection=o.Query({cacheStrategy:o.available,dependencies:{routes:t.routes},params:{},fetch:function(e){var t=e.routes.reduce(function(e,t){return r({},e,{features:e.features.concat(t.features)})},{type:"FeatureCollection",features:[]});return Promise.resolve(t)}})},712:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(713))},713:function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n(123);t.getRoutes=function(){return fetch("https://api.github.com/repos/BikeRoutes/Milano/contents").then(function(e){return e.json()}).then(function(e){var t=e.filter(function(e){return"dir"===e.type});return Promise.all(t.map(function(e){return fetch(e.url).then(function(e){return e.json()})}))}).then(o).then(function(e){return e.filter(function(e){return"file"===e.type&&e.name.includes(".geojson")})}).then(function(e){return Promise.all(e.map(function(e){return fetch(e.download_url).then(function(e){return e.json()}).then(function(t){return r({},t,{features:t.features.map(function(t){return r({},t,{properties:r({},t.properties,{url:e.html_url})})})})})}))})}},714:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.locationToView=function(e){switch(e.pathname){case"/hello":return"hello";default:return"home"}},t.viewToLocation=function(e){switch(e){case"hello":return{pathname:"/hello",search:{}};default:return{pathname:"/",search:{}}}}},723:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),o=n(724);n(734),t.default=function(e){return r.createElement(o.default,{className:"popup",column:!0},r.createElement(o.default,{className:"name"},e.feature.properties.name),r.createElement(o.default,{className:"distance"},r.createElement("label",null,"Distance")," ",e.feature.properties.length," km"),r.createElement(o.default,{className:"elevation"},r.createElement("label",null,"Elevation")," ",e.feature.properties.elevationGain," m"),r.createElement("a",{className:"github-button",href:e.feature.properties.url,target:"_blank"},"See on GitHub"))}},724:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(725);t.default=r.default},725:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(726);t.default=r.default},734:function(e,t,n){},735:function(e,t,n){},751:function(e,t){},757:function(e,t){},760:function(e,t,n){"use strict";n.r(t),n.d(t,"loadLocale",function(){return o});var r=n(70);function o(e){return new Promise(function(t){switch(e){case"it":return Promise.all([n.e(3),n.e(5)]).then(function(){var o=[n(774),n(775)];Object(r.addLocaleDataAndResolve)(e,t).apply(null,o)}.bind(this)).catch(n.oe);case"en":default:return Promise.all([n.e(2),n.e(4)]).then(function(){var o=[n(776),n(777)];Object(r.addLocaleDataAndResolve)(e,t).apply(null,o)}.bind(this)).catch(n.oe)}})}},761:function(e,t,n){"use strict";n.r(t);var r=n(113),o=n(112),a=n.n(o)()(),u=r({"is-desktop":a.isDesktop,"is-tablet":a.isTablet,"is-phone":a.isPhone}),i=document.documentElement||document.body;i.className=r(i.className,u)},762:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(763),n(770),n(772),n(773)},772:function(e,t,n){},773:function(e,t,n){}});
//# sourceMappingURL=main.bundle.cc10469c7e28d867ee90.js.map
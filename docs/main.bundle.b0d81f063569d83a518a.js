var webclient=function(e){function t(t){for(var o,u,i=t[0],c=t[1],s=t[2],f=0,p=[];f<i.length;f++)u=i[f],r[u]&&p.push(r[u][0]),r[u]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);for(l&&l(t);p.length;)p.shift()();return a.push.apply(a,s||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],o=!0,i=1;i<n.length;i++){var c=n[i];0!==r[c]&&(o=!1)}o&&(a.splice(t--,1),e=u(u.s=n[0]))}return e}var o={},r={0:0},a=[];function u(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var o=new Promise(function(t,o){n=r[e]=[t,o]});t.push(n[2]=o);var a,i=document.createElement("script");i.charset="utf-8",i.timeout=120,u.nc&&i.setAttribute("nonce",u.nc),i.src=function(e){return u.p+""+({}[e]||e)+".bundle.b0d81f063569d83a518a.js"}(e),a=function(t){i.onerror=i.onload=null,clearTimeout(c);var n=r[e];if(0!==n){if(n){var o=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src,u=new Error("Loading chunk "+e+" failed.\n("+o+": "+a+")");u.type=o,u.request=a,n[1](u)}r[e]=void 0}};var c=setTimeout(function(){a({type:"timeout",target:i})},12e4);i.onerror=i.onload=a,document.head.appendChild(i)}return Promise.all(t)},u.m=e,u.c=o,u.d=function(e,t,n){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},u.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)u.d(n,o,function(t){return e[t]}.bind(null,o));return n},u.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="/Explorer/",u.oe=function(e){throw console.error(e),e};var i=window.webpackJsonpwebclient=window.webpackJsonpwebclient||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var s=0;s<i.length;s++)t(i[s]);var l=c;return a.push([269,1]),n()}({267:function(e,t){},269:function(e,t,n){"use strict";n.r(t),n.d(t,"main",function(){return c}),n(270);var o=n(4),r=n(274),a=n(278).default,u=n(73).IntlProvider,i=n(769).loadLocale;function c(e){r.render(o.createElement(u,{loadLocale:i,locale:"it"},o.createElement(a,null)),e)}n(770),n(771)},270:function(e,t,n){n(271).polyfill(),n(272)},278:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(279);t.default=o.default},279:function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),a=n(116),u=n(706),i=n(71),c=n(727),s=n(743),l=n(264),f=a.declareQueries({routes:u.routes}),p=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.state={selectedRoute:l.none,hoveredRoute:l.none},e.onRouteSelect=function(t){e.setState({selectedRoute:e.state.selectedRoute.isSome()&&e.state.selectedRoute.value===t?l.none:l.some(t)})},e.onRouteHover=function(t){e.setState({hoveredRoute:t})},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),o(t,[{key:"render",value:function(){return this.props.routes.ready?r.createElement(i.default,{className:"app",height:"100%"},r.createElement(s.default,{routes:this.props.routes.value,onRouteClick:this.onRouteSelect,selectedRoute:this.state.selectedRoute}),r.createElement(c.default,{routes:this.props.routes.value,selectedRoute:this.state.selectedRoute,hoveredRoute:this.state.hoveredRoute,onRouteHover:this.onRouteHover,onRouteSelect:this.onRouteSelect})):null}}]),t}();t.default=f(p)},706:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(707))},707:function(e,t,n){"use strict";var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};Object.defineProperty(t,"__esModule",{value:!0});var r=n(116);t.location=r.location;var a=n(708),u=n(710),i=n(711),c=n(717);t.currentView=r.Query({params:{},dependencies:{location:r.location},fetch:function(e){var t=e.location;return Promise.resolve(u.locationToView(t))}}),t.routes=r.Query({cacheStrategy:r.available,params:{},fetch:function(){return a.getRoutes().then(function(e){return e.map(function(e){var t=e.features[0],n=o({},t,{properties:o({},t.properties,{color:i(t.properties.name),length:(c(t.geometry)/1e3).toFixed(1),elevationGain:Math.round(function(e){return e.reduce(function(t,n,o){var r=o>0?e[o-1][2]:void 0,a=n[2];return a&&r&&a>r?t+a-r:t},0)}(t.geometry.coordinates))})});return o({},e,{features:[n]})})})}})},708:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(709))},709:function(e,t,n){"use strict";var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};Object.defineProperty(t,"__esModule",{value:!0});var r=n(125);t.getRoutes=function(){return fetch("https://api.github.com/repos/BikeRoutes/Milano/contents").then(function(e){return e.json()}).then(function(e){var t=e.filter(function(e){return"dir"===e.type});return Promise.all(t.map(function(e){return fetch(e.url).then(function(e){return e.json()})}))}).then(r).then(function(e){return e.filter(function(e){return"file"===e.type&&e.name.includes(".geojson")})}).then(function(e){return Promise.all(e.map(function(e){return fetch(e.download_url).then(function(e){return e.json()}).then(function(t){var n=t.features[0];return o({},t,{features:[o({},n,{properties:o({},n.properties,{url:e.html_url})})]})})}))})}},71:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(718);t.default=o.default},710:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.locationToView=function(e){switch(e.pathname){case"/hello":return"hello";default:return"home"}},t.viewToLocation=function(e){switch(e){case"hello":return{pathname:"/hello",search:{}};default:return{pathname:"/",search:{}}}}},718:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(719);t.default=o.default},727:function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),a=n(728),u=n(730),i=n(734),c=n(735),s=n(71),l=n(264);n(742);var f=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.popup=i.popup({closeButton:!1,autoPan:!1}),e.layers=[],e.markers=[],e.onMouseMove=u(function(t){var n=e.props.routes.reduce(function(n,o){var r=o.features[0].geometry.coordinates.reduce(function(n,r){var a=i.latLng(r[1],r[0]),u=e.map.latLngToContainerPoint(i.latLng(r[1],r[0])).distanceTo(e.map.latLngToContainerPoint(t.latlng));return u<n.distance?{distance:u,point:a,route:o}:n},{distance:1/0});return r.distance<n.distance?r:n},{distance:1/0});if(n.distance<25){var o=n.route.features[0].geometry.coordinates[0],u=i.latLng(o[1],o[0]);e.popup.setLatLng(u).setContent(a.renderToString(r.createElement(c.default,{feature:n.route.features[0]}))).openOn(e.map),e.props.onRouteHover(l.some(n.route))}else e.props.onRouteHover(l.none),e.map.closePopup(e.popup)},30),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.PureComponent),o(t,[{key:"initializeMap",value:function(){var e=this;this.map=i.map("map",{preferCanvas:!1}),this.tileLayer=i.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}",{id:"mapbox.streets",accessToken:"pk.eyJ1IjoiZnJhbmNlc2NvY2lvcmlhIiwiYSI6ImNqcThzMDJrejJ1bzgzeGxjZTZ2aXR0cHMifQ.qzCmhZEf3Ta1YHvAfli3bA"}),this.map.addLayer(this.tileLayer),navigator.geolocation.getCurrentPosition(function(t){e.map.setView(i.latLng(t.coords.latitude,t.coords.longitude),12)})}},{key:"updateMap",value:function(){var e=this;this.layers.forEach(function(e){return e.remove()}),this.markers.forEach(function(e){return e.remove()}),this.layers=this.props.routes.map(function(t){var n=t.features[0],o=e.props.selectedRoute.isSome()&&t===e.props.selectedRoute.value||e.props.hoveredRoute.isSome()&&t===e.props.hoveredRoute.value?"#387ddf":n.properties.color;return i.geoJSON(t,{style:function(){return{color:o}}}).on("click",function(){e.props.onRouteSelect(t)})}),this.markers=this.props.routes.map(function(t){var n=t.features[0].geometry.coordinates[0],o=i.icon({iconUrl:"https://i.ibb.co/k55dg2z/marker-icon-2x.png",iconSize:[25,41],iconAnchor:[12.5,40],shadowUrl:"https://i.ibb.co/cYBsv0r/marker-shadow.png",shadowSize:[41,41],shadowAnchor:[12.5,40]});return i.marker([n[1],n[0]],{icon:o}).on("click",function(){e.props.onRouteSelect(t)})}),this.layers.forEach(function(t){return e.map.addLayer(t)}),this.markers.forEach(function(t){return t.addTo(e.map)}),this.map.on("mousemove",this.onMouseMove)}},{key:"componentDidMount",value:function(){this.initializeMap(),this.updateMap()}},{key:"componentDidUpdate",value:function(e){this.updateMap(),this.props.selectedRoute.isSome()&&(e.selectedRoute.isNone()||e.selectedRoute.value!==this.props.selectedRoute.value)&&this.map.fitBounds(this.props.selectedRoute.value.features[0].geometry.coordinates.map(function(e){return[e[1],e[0]]}))}},{key:"render",value:function(){return r.createElement(s.default,{grow:!0,id:"map"})}}]),t}();t.default=f},735:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),r=n(71);n(736),t.default=function(e){return o.createElement(r.default,{className:"popup",column:!0},o.createElement(r.default,{className:"name"},e.feature.properties.name),o.createElement(r.default,{className:"distance",vAlignContent:"bottom"},o.createElement("label",null,"Distance")," ",e.feature.properties.length," km"),o.createElement(r.default,{className:"elevation",vAlignContent:"bottom"},o.createElement("label",null,"Elevation")," ",e.feature.properties.elevationGain," m"))}},736:function(e,t,n){},743:function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),a=n(72),u=n(71);n(744);var i=function(e){return r.createElement(u.default,{className:a("route",{"is-selected":e.isSelected}),column:!0,onClick:e.onClick},r.createElement(u.default,{className:"name"},e.feature.properties.name),r.createElement(u.default,{className:"distance",vAlignContent:"bottom"},r.createElement("label",null,"Distance")," ",e.feature.properties.length," km"),r.createElement(u.default,{className:"elevation",vAlignContent:"bottom"},r.createElement("label",null,"Elevation")," ",e.feature.properties.elevationGain," m"),r.createElement(u.default,{className:"actions"},r.createElement("a",{className:"github-button",href:e.feature.properties.url,target:"_blank"},"See on GitHub")))},c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),o(t,[{key:"render",value:function(){var e=this;return r.createElement(u.default,{className:"side-bar",column:!0,shrink:!1},r.createElement("h2",null,"Routes"),this.props.routes.map(function(t,n){return r.createElement(i,{key:n,feature:t.features[0],onClick:function(){return e.props.onRouteClick(t)},isSelected:e.props.selectedRoute.isSome()&&e.props.selectedRoute.value===t})}))}}]),t}();t.default=c},744:function(e,t,n){},760:function(e,t){},766:function(e,t){},769:function(e,t,n){"use strict";n.r(t),n.d(t,"loadLocale",function(){return r});var o=n(73);function r(e){return new Promise(function(t){switch(e){case"it":return Promise.all([n.e(3),n.e(5)]).then(function(){var r=[n(783),n(784)];Object(o.addLocaleDataAndResolve)(e,t).apply(null,r)}.bind(this)).catch(n.oe);case"en":default:return Promise.all([n.e(2),n.e(4)]).then(function(){var r=[n(785),n(786)];Object(o.addLocaleDataAndResolve)(e,t).apply(null,r)}.bind(this)).catch(n.oe)}})}},770:function(e,t,n){"use strict";n.r(t);var o=n(72),r=n(115),a=n.n(r)()(),u=o({"is-desktop":a.isDesktop,"is-tablet":a.isTablet,"is-phone":a.isPhone}),i=document.documentElement||document.body;i.className=o(i.className,u)},771:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(772),n(779),n(781),n(782)},781:function(e,t,n){},782:function(e,t,n){}});
//# sourceMappingURL=main.bundle.b0d81f063569d83a518a.js.map
{"version":3,"sources":["webpack://webclient/webpack/bootstrap","webpack://webclient/./src/queries/index.ts","webpack://webclient/./src/model/index.ts","webpack://webclient/./src/components/Map/Map.tsx","webpack://webclient/./src/setup/index.js","webpack://webclient/./src/setup/polyfills.js","webpack://webclient/./src/components/App/index.ts","webpack://webclient/./src/components/App/App.tsx","webpack://webclient/./src/components/View/index.ts","webpack://webclient/./src/queries/queries.ts","webpack://webclient/./src/API/index.ts","webpack://webclient/./src/API/API.ts","webpack://webclient/./src/components/View/View.ts","webpack://webclient/./src/components/Explorer/Explorer.tsx","webpack://webclient/./src/components/Popup/Popup.tsx","webpack://webclient/./src/components/Marker/Marker.tsx","webpack://webclient/./src/components/SideBar/SideBar.tsx","webpack://webclient/./src/commands/index.ts","webpack://webclient/./src/commands/commands.ts","webpack://webclient/./src/components/Details/Details.tsx","webpack://webclient/./src/setup/loadLocale.js","webpack://webclient/./src/setup/addDeviceClassName.js","webpack://webclient/./src/theme/index.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","0","exports","module","l","e","promises","installedChunkData","promise","Promise","resolve","reject","onScriptComplete","script","document","createElement","charset","timeout","nc","setAttribute","src","p","event","onerror","onload","clearTimeout","chunk","errorType","type","realSrc","target","error","Error","request","setTimeout","head","appendChild","all","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","default","object","property","oe","err","console","jsonpArray","window","webpackJsonpwebclient","oldJsonpFunction","slice","require","314","Option_1","locationToView","location","search","view","routeId","fromNullable","viewToLocation","pathname","getOrElse","React","ReactDOMServer","ReactDOM","throttle","mapboxgl","Popup_1","Marker_1","View_1","mobileDetect_1","function_1","md","popupSettings","closeButton","closeOnClick","offset","anchor","getRouteDistanceInPixels","route","lngLat","map","geometry","coordinates","reduce","acc","point","project","LngLat","lng","lat","routePoint","distance","Math","sqrt","pow","abs","x","y","Infinity","App","this","_this","__proto__","getPrototypeOf","arguments","none","popupSelectedRoute","Popup","popupHoveredRoute","onMouseMove","closestRoute","props","routes","onRouteHover","some","PureComponent","_this2","accessToken","Map","container","style","zoom","on","addLayers","addMarkers","startPosition","querySelector","click","flyToRoute","animate","padding","isDesktop","innerRef","addControl","FullscreenControl","GeolocateControl","positionOptions","enableHighAccuracy","trackUserLocation","showUserLocation","fitBoundsOptions","maxZoom","NavigationControl","showZoom","showCompass","selectedRoute","isSome","hoveredRoute","properties","color","_this3","forEach","layer","id","url","source","layout","line-join","line-cap","paint","line-width","line-color","getRouteColor","onRouteSelect","addLayer","_this4","element","render","onClick","Marker","setLngLat","addTo","_this5","setPaintProperty","options","bounds","coord","LngLatBounds","extend","fitBounds","_extends","popup","latLng","setHTML","renderToString","showPopup","remove","fold","identity","initializeMap","prevProps","updateLayers","updateSelectedRoutePopup","updateHoveredRoutePopup","isNone","grow","__webpack_exports__","main","IntlProvider","loadLocale","mountNode","locale","347","polyfill","354","App_1","data_1","queries_1","Explorer_1","Details_1","queries","declareQueries","currentView","Component","ready","className","height","API","model_1","stringToColor","geoJsonLength","Query","params","dependencies","fetch","_ref","cacheStrategy","available","getRoutes","then","features","feature","richFeature","toFixed","elevationGain","round","index","prevAltitude","altitude","_ref2","find","routeReadme","_x","_fetch","toString","_ref3","readmeUrl","exec","text","768","assign","flatten","getGeoJSONs","contents","folders","filter","f","json","files","includes","download_url","html_url","res","geoJSONs","781","FlexView_1","Map_1","SideBar_1","sortBy","Explorer","state","setState","sortedRoutes","getCenter","onRouteClick","forceUpdate","column","vAlignContent","796","797","width","viewBox","cursor","marginTop","fillRule","transform","fill","opacity","cx","cy","rx","ry","801","configurable","writable","Button_1","commands_1","react_avenger_1","Route","is-selected","isSelected","shrink","size","label","onDetailsClick","commands","declareCommands","doUpdateLocation","SideBar","stopPropagation","869","Remarkable","file_saver_1","togpx","Markdown","images","querySelectorAll","h1","hAlignContent","position","left","clientWidth","flat","blob","Blob","saveAs","dangerouslySetInnerHTML","__html","Array","from","image","linkify","Details","_buildo_bento_utils__WEBPACK_IMPORTED_MODULE_0__","__WEBPACK_AMD_REQUIRE_ARRAY__","addLocaleDataAndResolve","catch","classnames__WEBPACK_IMPORTED_MODULE_0__","_buildo_bento_utils_mobileDetect__WEBPACK_IMPORTED_MODULE_1__","deviceClassName","is-desktop","is-tablet","isTablet","is-phone","isPhone","body","documentElement","964","965"],"mappings":"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","file":"main.bundle.14f2d2ed84a490d4fd88.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t0: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"\" + ({}[chunkId]||chunkId) + \".bundle.\" + \"14f2d2ed84a490d4fd88\" + \".js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar promises = [];\n\n\n \t\t// JSONP chunk loading for javascript\n\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n \t\t\t// a Promise means \"currently loading\".\n \t\t\tif(installedChunkData) {\n \t\t\t\tpromises.push(installedChunkData[2]);\n \t\t\t} else {\n \t\t\t\t// setup Promise in chunk cache\n \t\t\t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t\t\t});\n \t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n \t\t\t\t// start chunk loading\n \t\t\t\tvar script = document.createElement('script');\n \t\t\t\tvar onScriptComplete;\n\n \t\t\t\tscript.charset = 'utf-8';\n \t\t\t\tscript.timeout = 120;\n \t\t\t\tif (__webpack_require__.nc) {\n \t\t\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t\t\t}\n \t\t\t\tscript.src = jsonpScriptSrc(chunkId);\n\n \t\t\t\tonScriptComplete = function (event) {\n \t\t\t\t\t// avoid mem leaks in IE.\n \t\t\t\t\tscript.onerror = script.onload = null;\n \t\t\t\t\tclearTimeout(timeout);\n \t\t\t\t\tvar chunk = installedChunks[chunkId];\n \t\t\t\t\tif(chunk !== 0) {\n \t\t\t\t\t\tif(chunk) {\n \t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n \t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n \t\t\t\t\t\t\tvar error = new Error('Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')');\n \t\t\t\t\t\t\terror.type = errorType;\n \t\t\t\t\t\t\terror.request = realSrc;\n \t\t\t\t\t\t\tchunk[1](error);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t\t\t}\n \t\t\t\t};\n \t\t\t\tvar timeout = setTimeout(function(){\n \t\t\t\t\tonScriptComplete({ type: 'timeout', target: script });\n \t\t\t\t}, 120000);\n \t\t\t\tscript.onerror = script.onload = onScriptComplete;\n \t\t\t\tdocument.head.appendChild(script);\n \t\t\t}\n \t\t}\n \t\treturn Promise.all(promises);\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/Explorer/\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonpwebclient\"] = window[\"webpackJsonpwebclient\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([346,1]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./queries\"));\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst Option_1 = require(\"fp-ts/lib/Option\");\nfunction locationToView(location) {\n    switch (location.search.view) {\n        case \"details\":\n            return {\n                view: \"details\",\n                routeId: Option_1.fromNullable(location.search.routeId)\n            };\n        default:\n            return { view: \"explorer\" };\n    }\n}\nexports.locationToView = locationToView;\nfunction viewToLocation(view) {\n    switch (view.view) {\n        case \"details\":\n            return {\n                pathname: \"/Explorer\",\n                search: { view: \"details\", routeId: view.routeId.getOrElse(\"\") }\n            };\n        case \"explorer\":\n            return { pathname: \"/Explorer\", search: {} };\n    }\n}\nexports.viewToLocation = viewToLocation;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst React = require(\"react\");\nconst ReactDOMServer = require(\"react-dom/server\");\nconst ReactDOM = require(\"react-dom\");\nconst throttle = require(\"lodash/throttle\");\nconst mapboxgl = require(\"mapbox-gl\");\nconst Popup_1 = require(\"Popup/Popup\");\nconst Marker_1 = require(\"Marker/Marker\");\nconst View_1 = require(\"View\");\nconst Option_1 = require(\"fp-ts/lib/Option\");\nconst mobileDetect_1 = require(\"@buildo/bento/utils/mobileDetect\");\nconst function_1 = require(\"fp-ts/lib/function\");\nrequire(\"mapbox-gl/dist/mapbox-gl.css\");\nconst md = mobileDetect_1.default();\nconst popupSettings = {\n    closeButton: false,\n    closeOnClick: true,\n    offset: [0, -40],\n    anchor: \"bottom\"\n};\nexports.getRouteDistanceInPixels = (route, lngLat, map) => {\n    return route.geometry.coordinates.reduce((acc, coordinates) => {\n        const point = map.project(new mapboxgl.LngLat(lngLat.lng, lngLat.lat));\n        const routePoint = map.project(new mapboxgl.LngLat(coordinates[0], coordinates[1]));\n        const distance = Math.sqrt(Math.pow(Math.abs(point.x - routePoint.x), 2) +\n            Math.pow(Math.abs(point.y - routePoint.y), 2));\n        return distance < acc ? distance : acc;\n    }, Infinity);\n};\nclass App extends React.PureComponent {\n    constructor() {\n        super(...arguments);\n        this.map = Option_1.none;\n        this.popupSelectedRoute = new mapboxgl.Popup(popupSettings);\n        this.popupHoveredRoute = new mapboxgl.Popup(popupSettings);\n        this.onMouseMove = throttle((e) => {\n            this.map.map(map => {\n                const closestRoute = this.props.routes.reduce((acc, route) => {\n                    const distance = exports.getRouteDistanceInPixels(route, e.lngLat, map);\n                    return distance < acc.distance ? { distance, route } : acc;\n                }, { distance: Infinity });\n                if (closestRoute.distance < 25) {\n                    this.props.onRouteHover(Option_1.some(closestRoute.route));\n                }\n                else {\n                    this.props.onRouteHover(Option_1.none);\n                }\n            });\n        }, 60);\n    }\n    initializeMap() {\n        mapboxgl.accessToken =\n            \"pk.eyJ1IjoiZnJhbmNlc2NvY2lvcmlhIiwiYSI6ImNqcThyejR6ODA2ZDk0M25rZzZjcGo4ZmcifQ.yRWHQbG1dJjDp43d01bBOw\";\n        const map = new mapboxgl.Map({\n            container: \"map\",\n            style: \"mapbox://styles/francescocioria/cjqi3u6lmame92rmw6aw3uyhm\",\n            zoom: 11.0\n        });\n        map.on(\"load\", () => {\n            this.map = Option_1.some(map);\n            this.addLayers();\n            this.addMarkers();\n            if (this.props.startPosition === \"userLocation\") {\n                document\n                    .querySelector(\".mapboxgl-ctrl-geolocate\")\n                    .click();\n            }\n            if (this.props.startPosition === \"firstRoute\" &&\n                this.props.routes.length > 0) {\n                this.flyToRoute(this.props.routes[0], { animate: false, padding: 80 });\n            }\n        });\n        if (md.isDesktop) {\n            map.on(\"mousemove\", this.onMouseMove);\n        }\n        map.on(\"moveend\", () => this.props.innerRef(this.map));\n        map.addControl(new mapboxgl.FullscreenControl());\n        map.addControl(new mapboxgl.GeolocateControl({\n            positionOptions: {\n                enableHighAccuracy: true\n            },\n            trackUserLocation: true,\n            showUserLocation: true,\n            fitBoundsOptions: {\n                maxZoom: this.props.startPosition === \"firstRoute\" ? 15 : 11\n            }\n        }));\n        map.addControl(new mapboxgl.NavigationControl({\n            showZoom: md.isDesktop,\n            showCompass: !md.isDesktop\n        }));\n    }\n    getRouteColor(route) {\n        return (this.props.selectedRoute.isSome() &&\n            route === this.props.selectedRoute.value) ||\n            (this.props.hoveredRoute.isSome() &&\n                route === this.props.hoveredRoute.value)\n            ? \"#387ddf\"\n            : route.properties.color;\n    }\n    addLayers() {\n        this.map.map(map => {\n            this.props.routes.forEach(route => {\n                const layer = {\n                    id: route.properties.url,\n                    type: \"line\",\n                    source: {\n                        type: \"geojson\",\n                        data: route\n                    },\n                    layout: {\n                        \"line-join\": \"round\",\n                        \"line-cap\": \"round\"\n                    },\n                    paint: {\n                        \"line-width\": 3,\n                        \"line-color\": this.getRouteColor(route)\n                    }\n                };\n                map.on(\"click\", layer.id, () => {\n                    this.props.onRouteSelect(route);\n                });\n                map.addLayer(layer);\n            });\n        });\n    }\n    addMarkers() {\n        this.map.map(map => {\n            this.props.routes.forEach(route => {\n                const coordinates = route.geometry.coordinates[0];\n                const element = document.createElement(\"div\");\n                ReactDOM.render(React.createElement(Marker_1.default, { onClick: () => this.props.onRouteSelect(route) }), element);\n                const marker = new mapboxgl.Marker({\n                    element\n                }).setLngLat([coordinates[0], coordinates[1]]);\n                marker.addTo(map);\n            });\n        });\n    }\n    updateLayers() {\n        this.map.map(map => {\n            this.props.routes.forEach(route => {\n                map.setPaintProperty(route.id, \"line-color\", this.getRouteColor(route));\n            });\n        });\n    }\n    flyToRoute(route, options) {\n        this.map.map(map => {\n            const coordinates = route.geometry.coordinates;\n            const bounds = coordinates\n                .map(coord => new mapboxgl.LngLatBounds(coord, coord))\n                .reduce((bounds, coord) => {\n                return bounds.extend(coord);\n            });\n            map.fitBounds(bounds, { padding: 50, ...options });\n        });\n    }\n    showPopup(route, popup) {\n        this.map.map(map => {\n            const latLng = new mapboxgl.LngLat(route.geometry.coordinates[0][0], route.geometry.coordinates[0][1]);\n            popup\n                .setLngLat(latLng)\n                .setHTML(ReactDOMServer.renderToString(React.createElement(Popup_1.default, { route: route })))\n                .addTo(map);\n        });\n    }\n    updateSelectedRoutePopup() {\n        if (this.props.selectedRoute.isSome()) {\n            this.showPopup(this.props.selectedRoute.value, this.popupSelectedRoute);\n        }\n        else {\n            this.popupSelectedRoute.remove();\n        }\n    }\n    updateHoveredRoutePopup() {\n        const { hoveredRoute } = this.props;\n        if (hoveredRoute.isSome() &&\n            hoveredRoute.value !== this.props.selectedRoute.fold(null, function_1.identity)) {\n            this.showPopup(hoveredRoute.value, this.popupHoveredRoute);\n        }\n        else {\n            this.popupHoveredRoute.remove();\n        }\n    }\n    componentDidMount() {\n        this.initializeMap();\n        this.props.innerRef(this.map);\n    }\n    componentDidUpdate(prevProps) {\n        this.updateLayers();\n        this.updateSelectedRoutePopup();\n        this.updateHoveredRoutePopup();\n        if (this.props.selectedRoute.isSome() &&\n            (prevProps.selectedRoute.isNone() ||\n                prevProps.selectedRoute.value !== this.props.selectedRoute.value)) {\n            this.flyToRoute(this.props.selectedRoute.value);\n        }\n    }\n    render() {\n        return React.createElement(View_1.default, { grow: true, id: \"map\" });\n    }\n}\nexports.default = App;\n","/*\n\nThis file prepares the app before rendering with React,\nadding custom polyfills and setting up the `react-intl` provider.\n\nYou shouldn't need to edit this file.\n\n*/\n\nimport './polyfills';\n\n// using require to guarantee they're imported after polyfills are installed\nconst React = require('react');\nconst ReactDOM = require('react-dom');\nconst App = require('components/App').default;\nconst { IntlProvider } = require('@buildo/bento/utils');\nconst { loadLocale } = require('./loadLocale');\n\nrequire('./addDeviceClassName');\nrequire('theme');\n\nexport function main(mountNode) {\n  ReactDOM.render((\n    <IntlProvider loadLocale={loadLocale} locale='it'>\n      <App />\n    </IntlProvider>\n  ), mountNode);\n}\n","require('es6-promise').polyfill();\nrequire('whatwg-fetch');\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst App_1 = require(\"./App\");\nexports.default = App_1.default;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst React = require(\"react\");\nconst data_1 = require(\"@buildo/bento/data\");\nconst queries_1 = require(\"queries\");\nconst View_1 = require(\"View\");\nconst Explorer_1 = require(\"Explorer/Explorer\");\nconst Details_1 = require(\"Details/Details\");\nconst queries = data_1.declareQueries({ currentView: queries_1.currentView });\nclass App extends React.Component {\n    render() {\n        if (!this.props.currentView.ready) {\n            return null;\n        }\n        return (React.createElement(View_1.default, { className: \"app\", height: \"100%\" },\n            this.props.currentView.value.view === \"explorer\" && React.createElement(Explorer_1.default, null),\n            this.props.currentView.value.view === \"details\" && React.createElement(Details_1.default, null)));\n    }\n}\nexports.default = queries(App);\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst View_1 = require(\"./View\");\nexports.default = View_1.default;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst data_1 = require(\"@buildo/bento/data\");\nexports.location = data_1.location;\nconst API = require(\"API\");\nconst model_1 = require(\"model\");\nconst stringToColor = require(\"string-to-color\");\nconst geoJsonLength = require(\"geojson-length\");\nconst Option_1 = require(\"fp-ts/lib/Option\");\nfunction getElevationGain(coordinates) {\n    return coordinates.reduce((acc, c, index) => {\n        const prevAltitude = index > 0 ? coordinates[index - 1][2] : undefined;\n        const altitude = c[2];\n        if (altitude && prevAltitude && altitude > prevAltitude) {\n            return acc + altitude - prevAltitude;\n        }\n        return acc;\n    }, 0);\n}\nexports.currentView = data_1.Query({\n    params: {},\n    dependencies: { location: data_1.location },\n    fetch: ({ location }) => Promise.resolve(model_1.locationToView(location))\n});\nexports.routes = data_1.Query({\n    cacheStrategy: data_1.available,\n    params: {},\n    fetch: () => API.getRoutes().then(features => features.map(feature => {\n        const richFeature = {\n            id: feature.properties.url,\n            ...feature,\n            properties: {\n                ...feature.properties,\n                color: stringToColor(feature.properties.name),\n                length: (geoJsonLength(feature.geometry) / 1000).toFixed(1),\n                elevationGain: Math.round(getElevationGain(feature.geometry.coordinates))\n            }\n        };\n        return richFeature;\n    }))\n});\nexports.route = data_1.Query({\n    params: {},\n    dependencies: { currentView: exports.currentView, routes: exports.routes },\n    fetch: ({ currentView, routes }) => {\n        if (currentView.view === \"details\" && currentView.routeId.isSome()) {\n            const routeId = currentView.routeId.value;\n            return Promise.resolve(Option_1.fromNullable(routes.find(r => r.id === routeId)));\n        }\n        return Promise.resolve(Option_1.none);\n    }\n});\nexports.routeReadme = data_1.Query({\n    params: {},\n    dependencies: { route: exports.route },\n    fetch: ({ route }) => {\n        if (route.isSome()) {\n            const res = /BikeRoutes.+master\\/(.+)\\/.+$/.exec(route.value.properties.url);\n            const readmeUrl = `https://raw.githubusercontent.com/BikeRoutes/BikeRoutes/master/${res[1]}/README.md`;\n            return fetch(readmeUrl)\n                .then(r => r.text())\n                .then(text => Option_1.some(text));\n        }\n        return Promise.resolve(Option_1.none);\n    }\n});\n","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./API\"));\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst flatten = require(\"lodash/flatten\");\nfunction getGeoJSONs(contents) {\n    const folders = contents.filter(c => c.type === \"dir\");\n    if (folders.length > 0) {\n        return Promise.all(folders.map(f => fetch(f.url).then(r => r.json())))\n            .then(flatten)\n            .then(getGeoJSONs);\n    }\n    else {\n        const files = contents.filter(c => c.type === \"file\" && c.name.includes(\".geojson\"));\n        return Promise.all(files.map(f => fetch(f.download_url)\n            .then(r => r.json())\n            .then(x => ({\n            ...x,\n            features: [\n                {\n                    ...x.features[0],\n                    properties: {\n                        ...x.features[0].properties,\n                        url: f.html_url\n                    }\n                }\n            ]\n        }))));\n    }\n}\nexports.getRoutes = () => {\n    return fetch(\"https://api.github.com/repos/BikeRoutes/Milano/contents\")\n        .then(res => res.json())\n        .then(getGeoJSONs)\n        .then(geoJSONs => geoJSONs.map(route => route.features[0]));\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst FlexView_1 = require(\"@buildo/bento/components/FlexView\");\nexports.default = FlexView_1.default;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst React = require(\"react\");\nconst data_1 = require(\"@buildo/bento/data\");\nconst queries_1 = require(\"queries\");\nconst View_1 = require(\"View\");\nconst Map_1 = require(\"Map/Map\");\nconst SideBar_1 = require(\"SideBar/SideBar\");\nconst Option_1 = require(\"fp-ts/lib/Option\");\nconst sortBy = require(\"lodash/sortBy\");\nrequire(\"./explorer.scss\");\nconst queries = data_1.declareQueries({ routes: queries_1.routes });\nclass Explorer extends React.Component {\n    constructor() {\n        super(...arguments);\n        this.map = Option_1.none;\n        this.state = {\n            selectedRoute: Option_1.none,\n            hoveredRoute: Option_1.none\n        };\n        this.onRouteSelect = (route) => {\n            this.setState({\n                selectedRoute: this.state.selectedRoute.isSome() &&\n                    this.state.selectedRoute.value === route\n                    ? Option_1.none\n                    : Option_1.some(route)\n            });\n        };\n        this.onRouteHover = (route) => {\n            this.setState({\n                hoveredRoute: route\n            });\n        };\n    }\n    render() {\n        const routes = this.props.routes;\n        if (!routes.ready) {\n            return null;\n        }\n        const sortedRoutes = this.map.fold(routes.value, map => sortBy(routes.value, route => Map_1.getRouteDistanceInPixels(route, map.getCenter(), map)));\n        return (React.createElement(View_1.default, { className: \"explorer\", grow: true },\n            React.createElement(SideBar_1.default, { routes: sortedRoutes, onRouteClick: this.onRouteSelect, selectedRoute: this.state.selectedRoute }),\n            React.createElement(Map_1.default, { routes: routes.value, selectedRoute: this.state.selectedRoute, hoveredRoute: this.state.hoveredRoute, onRouteHover: this.onRouteHover, onRouteSelect: this.onRouteSelect, innerRef: map => {\n                    this.map = map;\n                    this.forceUpdate();\n                }, startPosition: \"userLocation\" })));\n    }\n}\nexports.default = queries(Explorer);\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst React = require(\"react\");\nconst View_1 = require(\"View\");\nrequire(\"./popup.scss\");\nexports.default = (props) => (React.createElement(View_1.default, { className: \"popup\", column: true },\n    React.createElement(View_1.default, { className: \"name\" }, props.route.properties.name),\n    React.createElement(View_1.default, { className: \"distance\", vAlignContent: \"bottom\" },\n        React.createElement(\"label\", null, \"Distance\"),\n        \" \",\n        props.route.properties.length,\n        \" km\"),\n    React.createElement(View_1.default, { className: \"elevation\", vAlignContent: \"bottom\" },\n        React.createElement(\"label\", null, \"Elevation\"),\n        \" \",\n        props.route.properties.elevationGain,\n        \" m\")));\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst React = require(\"react\");\nexports.default = (props) => (React.createElement(\"svg\", { height: \"41px\", width: \"27px\", viewBox: \"0 0 27 41\", onClick: props.onClick, className: \"marker\", style: { cursor: \"pointer\", marginTop: \"-100%\" } },\n    React.createElement(\"g\", { fillRule: \"nonzero\" },\n        React.createElement(\"g\", { transform: \"translate(3.0, 29.0)\", fill: \"#000000\" },\n            React.createElement(\"ellipse\", { opacity: \"0.04\", cx: \"10.5\", cy: \"5.80029008\", rx: \"10.5\", ry: \"5.25002273\" }),\n            React.createElement(\"ellipse\", { opacity: \"0.04\", cx: \"10.5\", cy: \"5.80029008\", rx: \"10.5\", ry: \"5.25002273\" }),\n            React.createElement(\"ellipse\", { opacity: \"0.04\", cx: \"10.5\", cy: \"5.80029008\", rx: \"9.5\", ry: \"4.77275007\" }),\n            React.createElement(\"ellipse\", { opacity: \"0.04\", cx: \"10.5\", cy: \"5.80029008\", rx: \"8.5\", ry: \"4.29549936\" }),\n            React.createElement(\"ellipse\", { opacity: \"0.04\", cx: \"10.5\", cy: \"5.80029008\", rx: \"7.5\", ry: \"3.81822308\" }),\n            React.createElement(\"ellipse\", { opacity: \"0.04\", cx: \"10.5\", cy: \"5.80029008\", rx: \"6.5\", ry: \"3.34094679\" }),\n            React.createElement(\"ellipse\", { opacity: \"0.04\", cx: \"10.5\", cy: \"5.80029008\", rx: \"5.5\", ry: \"2.86367051\" }),\n            React.createElement(\"ellipse\", { opacity: \"0.04\", cx: \"10.5\", cy: \"5.80029008\", rx: \"4.5\", ry: \"2.38636864\" })),\n        React.createElement(\"g\", { fill: \"#3FB1CE\" },\n            React.createElement(\"path\", { d: \"M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z\" })),\n        React.createElement(\"g\", { opacity: \"0.25\", fill: \"#000000\" },\n            React.createElement(\"path\", { d: \"M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z\" })),\n        React.createElement(\"g\", { transform: \"translate(6.0, 7.0)\", fill: \"#FFFFFF\" }),\n        React.createElement(\"g\", { transform: \"translate(8.0, 8.0)\" },\n            React.createElement(\"circle\", { fill: \"#000000\", opacity: \"0.25\", cx: \"5.5\", cy: \"5.5\", r: \"5.4999962\" }),\n            React.createElement(\"circle\", { fill: \"#FFFFFF\", cx: \"5.5\", cy: \"5.5\", r: \"5.4999962\" })))));\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst React = require(\"react\");\nconst cx = require(\"classnames\");\nconst View_1 = require(\"View\");\nconst model_1 = require(\"model\");\nconst Option_1 = require(\"fp-ts/lib/Option\");\nconst Button_1 = require(\"@buildo/bento/components/Button\");\nconst commands_1 = require(\"commands\");\nconst react_avenger_1 = require(\"react-avenger\");\nrequire(\"./sideBar.scss\");\nrequire(\"@buildo/bento/components/button.scss\");\nconst Route = (props) => (React.createElement(View_1.default, { className: cx(\"route\", { \"is-selected\": props.isSelected }), column: true, onClick: props.onClick, shrink: false },\n    React.createElement(View_1.default, { className: \"name\" }, props.route.properties.name),\n    React.createElement(View_1.default, { className: \"distance\", vAlignContent: \"bottom\" },\n        React.createElement(\"label\", null, \"Distance\"),\n        \" \",\n        props.route.properties.length,\n        \" km\"),\n    React.createElement(View_1.default, { className: \"elevation\", vAlignContent: \"bottom\" },\n        React.createElement(\"label\", null, \"Elevation\"),\n        \" \",\n        props.route.properties.elevationGain,\n        \" m\"),\n    React.createElement(View_1.default, { className: \"actions\" },\n        React.createElement(Button_1.default, { size: \"tiny\", label: \"Details\", onClick: props.onDetailsClick }))));\nconst commands = react_avenger_1.declareCommands({ doUpdateLocation: commands_1.doUpdateLocation });\nclass SideBar extends React.Component {\n    render() {\n        return (React.createElement(View_1.default, { className: \"side-bar\", column: true, shrink: false },\n            React.createElement(\"h2\", null, \"Routes\"),\n            this.props.routes.map((route, index) => (React.createElement(Route, { key: index, route: route, onClick: () => this.props.onRouteClick(route), isSelected: this.props.selectedRoute.isSome() &&\n                    this.props.selectedRoute.value === route, onDetailsClick: e => {\n                    e.stopPropagation();\n                    this.props.doUpdateLocation(model_1.viewToLocation({ view: \"details\", routeId: Option_1.some(route.id) }));\n                } })))));\n    }\n}\nexports.default = commands(SideBar);\n","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./commands\"));\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst data_1 = require(\"@buildo/bento/data\");\nexports.doUpdateLocation = data_1.doUpdateLocation;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst React = require(\"react\");\nconst data_1 = require(\"@buildo/bento/data\");\nconst queries_1 = require(\"queries\");\nconst View_1 = require(\"View\");\nconst Map_1 = require(\"../Map/Map\");\nconst Remarkable = require(\"remarkable\");\nconst Option_1 = require(\"fp-ts/lib/Option\");\nconst Button_1 = require(\"@buildo/bento/components/Button\");\nconst file_saver_1 = require(\"file-saver\");\nconst togpx = require(\"togpx\");\nrequire(\"./details.scss\");\nconst saveGPX = (route) => {\n    const blob = new Blob([togpx(route)], {\n        type: \"text/plain;charset=utf-8\"\n    });\n    file_saver_1.saveAs(blob, `${route.properties.name}.gpx`);\n};\nclass Markdown extends React.PureComponent {\n    componentDidMount() {\n        this.forceUpdate();\n    }\n    render() {\n        const images = document.querySelectorAll(\".markdown img\");\n        const h1 = document.querySelector(\"h1\");\n        return (React.createElement(View_1.default, { className: \"markdown\", hAlignContent: \"center\", shrink: false },\n            React.createElement(View_1.default, { className: \"wrapper\", grow: true },\n                React.createElement(View_1.default, { grow: true, column: true, style: { position: \"relative\" } },\n                    React.createElement(View_1.default, { className: \"actions\", style: { left: h1 ? h1.clientWidth : undefined } },\n                        React.createElement(Button_1.default, { flat: true, size: \"tiny\", label: \"Download GPX\", onClick: () => saveGPX(this.props.route) })),\n                    React.createElement(\"div\", { className: \"remarkable\", dangerouslySetInnerHTML: {\n                            __html: md.render(this.props.routeReadme)\n                        } }),\n                    React.createElement(View_1.default, { className: \"summary\" },\n                        React.createElement(View_1.default, { className: \"distance\", column: true },\n                            React.createElement(\"span\", null,\n                                this.props.route.properties.length,\n                                \" km\"),\n                            React.createElement(\"label\", null, \"Distance\")),\n                        React.createElement(View_1.default, { className: \"elevation\", column: true },\n                            React.createElement(\"span\", null,\n                                this.props.route.properties.elevationGain,\n                                \" m\"),\n                            React.createElement(\"label\", null, \"Elevation\")))),\n                React.createElement(View_1.default, { className: \"images\", hAlignContent: \"right\", shrink: false }, Array.from(images).map(image => (React.createElement(\"img\", { key: image.src, src: image.src })))))));\n    }\n}\nconst md = new Remarkable({\n    linkify: true\n});\nconst queries = data_1.declareQueries({ route: queries_1.route, routeReadme: queries_1.routeReadme });\nclass Details extends React.Component {\n    render() {\n        if (!this.props.route.ready ||\n            this.props.route.value.isNone() ||\n            !this.props.routeReadme.ready ||\n            this.props.routeReadme.value.isNone()) {\n            return null;\n        }\n        return (React.createElement(View_1.default, { className: \"details\", height: \"100%\", grow: true, column: true },\n            React.createElement(Markdown, { routeReadme: this.props.routeReadme.value.value, route: this.props.route.value.value }),\n            React.createElement(View_1.default, { shrink: false, className: \"map-wrapper\" },\n                React.createElement(Map_1.default, { routes: [this.props.route.value.value], startPosition: \"firstRoute\", hoveredRoute: Option_1.none, selectedRoute: Option_1.none, onRouteHover: () => { }, onRouteSelect: () => { }, innerRef: () => { } }))));\n    }\n}\nexports.default = queries(Details);\n","import { addLocaleDataAndResolve } from '@buildo/bento/utils';\n\n/*\n\nIn this `loadLocale` function we import the required locale data for our app.\nThis function ensures only the required files are loaded based on the locale we want to serve to the user.\n\nThe stesp to add a new locale (language) are:\n- create a new file in `locales`, such as `myLang.json`. It should respect the format of the other locale files\n- add the new `case` in the function below.\nThe documentation for `react-intl/locale-data` packages can be found at https://github.com/yahoo/react-intl/wiki#loading-locale-data\n\n*/\n\nexport function loadLocale(locale) {\n  return new Promise(resolve => {\n    switch (locale) {\n      case 'it':\n        return require(\n          ['locales/it', 'react-intl/locale-data/it'],\n          addLocaleDataAndResolve(locale, resolve)\n        );\n      case 'en':\n      default:\n        return require(\n          ['locales/en', 'react-intl/locale-data/en'],\n          addLocaleDataAndResolve(locale, resolve)\n        );\n    }\n  });\n}","// This script adds \"is-desktop\", \"is-phone\" or \"is-tablet\" class to the root document element\n\nimport * as cx from 'classnames';\nimport mobileDetect from '@buildo/bento/utils/mobileDetect';\n\nconst md = mobileDetect();\n\nconst deviceClassName = cx({\n  'is-desktop': md.isDesktop,\n  'is-tablet': md.isTablet,\n  'is-phone': md.isPhone\n});\n\n// document.documentElement is not supported in every browser, fallback on document.body\nconst body = (document.documentElement || document.body);\n\nbody.className = cx(body.className, deviceClassName);\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nrequire(\"@buildo/bento/theme/normalize-css\");\nrequire(\"@buildo/bento/theme/normalize-css/fullscreenApp\");\nrequire(\"./main.scss\");\nrequire(\"./typography.scss\");\n"],"sourceRoot":""}
(this.webpackJsonpexplorer=this.webpackJsonpexplorer||[]).push([[0],{1103:function(e,t,n){},1105:function(e,t,n){},1110:function(e,t,n){},1123:function(e,t,n){},1124:function(e,t,n){},1126:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n.n(o),r=n(41),i=n.n(r),c=n(10),s=n(11),l=n(17),u=n(16),p=n(13),m=n(18),d=n(2);function h(e){switch(e.view){case"details":return{pathname:"/Explorer",search:{view:"details",routeId:e.routeId.getOrElse("")}};case"navigation":return{pathname:"/Explorer",search:{view:"navigation",routeId:e.routeId.getOrElse("")}};case"explorer":return{pathname:"/Explorer",search:{}}}}var f=n(223),g=n(224),v=function(e){return(t=e,Object(d.fromNullable)(/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t)).map((function(e){return{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}}))).fold(!1,(function(e){var t=[e.r/255,e.g/255,e.b/255].map((function(e){return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)})),n=.2126*t[0]+.7152*t[1]+.0722*t[2];return n<=.5&&n>=.1}));var t},b=function e(t,n){var o="".concat(t,"$");return v(n)?n:e(o,g(o))},E=function(e){return b(e,g(e))},k=n(886);var y=Object(p.Query)({params:{},dependencies:{location:p.location},fetch:function(e){var t=e.location;return Promise.resolve(function(e){switch(e.search.view){case"details":return{view:"details",routeId:Object(d.fromNullable)(e.search.routeId)};case"navigation":return{view:"navigation",routeId:Object(d.fromNullable)(e.search.routeId)};default:return{view:"explorer"}}}(t))}}),w=function(e){var t,n=e.geometry.coordinates.reduce((function(e,t){return t[2]&&t[2]<e?t[2]:e}),Number.MAX_SAFE_INTEGER),o=e.geometry.coordinates.reduce((function(e,t){return t[2]&&t[2]>e?t[2]:e}),Number.MIN_SAFE_INTEGER),a=e.geometry.coordinates.reduce((function(t,n,o){if(0===o)return t.concat(0);var a=f({type:"LineString",coordinates:e.geometry.coordinates.slice(o-1,o+1)})/1e3;return t.concat(t[o-1]+a)}),[]);return Object(m.a)(Object(m.a)({id:e.properties.url},e),{},{properties:Object(m.a)(Object(m.a)({},e.properties),{},{color:"gpx"!==e.properties.url?E(e.properties.name):"#38ffcc",length:Math.round(f(e.geometry)/100)/10,elevationGain:Math.round((t=e.geometry.coordinates,t.filter((function(e){return e[2]})).reduce((function(e,n,o){var a=o>0?t[o-1][2]:void 0,r=n[2];return a&&r>a?e+r-a:e}),0))),minElevation:n,maxElevation:o,distances:a})})},C=Object(p.Query)({cacheStrategy:p.available,params:{},fetch:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){return fetch("https://or52hotxz1.execute-api.us-east-1.amazonaws.com/dev/").then((function(e){return e.json()})).then((function(e){return JSON.parse(e.body)})).then((function(e){return e.map(w)}))}))}),R=Object(p.Query)({params:{},dependencies:{currentView:y,routes:C},fetch:function(e){var t=e.currentView,n=e.routes;if(("details"===t.view||"navigation"===t.view)&&t.routeId.isSome()){var o=t.routeId.value;if("gpx"===o){var a=new DOMParser;return Promise.resolve(Object(d.fromNullable)(localStorage.getItem("gpxFile")).map((function(e){var t=k.gpx(a.parseFromString(e,"text/xml")).features.filter((function(e){return"LineString"===e.geometry.type})).reduce((function(e,t){return Object(m.a)(Object(m.a)({},e),{},{geometry:Object(m.a)(Object(m.a)({},e.geometry),{},{coordinates:e.geometry.coordinates.concat(t.geometry.coordinates)})})}));return w(Object(m.a)(Object(m.a)({},t),{},{properties:Object(m.a)(Object(m.a)({},t.properties),{},{url:"gpx"})}))})))}return Promise.resolve(Object(d.fromNullable)(n.find((function(e){return e.id===o}))))}return Promise.resolve(d.none)}}),S=Object(p.Query)({params:{},dependencies:{route:R},fetch:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var t=e.route;if(t.isSome()){var n=/BikeRoutes.+master\/(.+)\/.+$/.exec(t.value.properties.url),o="https://raw.githubusercontent.com/BikeRoutes/BikeRoutes/master/".concat(n[1],"/README.md");return fetch(o).then((function(e){return e.text()})).then((function(e){return Object(d.some)(e)}))}return Promise.resolve(d.none)}))}),O=n(439),L=n.n(O).a,x=n(440),j=n(99),N=n.n(j),M=(n(895),function(e){return o.createElement(L,{className:"popup",column:!0},o.createElement(L,{className:"name"},e.route.properties.name),o.createElement(L,{className:"distance",vAlignContent:"bottom"},o.createElement("label",null,"Distance")," ",e.route.properties.length," km"),o.createElement(L,{className:"elevation",vAlignContent:"bottom"},o.createElement("label",null,"Elevation")," ",e.route.properties.elevationGain," m"))}),P=function(e){return o.createElement("svg",{height:"41px",width:"27px",viewBox:"0 0 27 41",onClick:e.onClick,className:"marker",style:{cursor:"pointer",marginTop:"-100%"}},o.createElement("g",{fillRule:"nonzero"},o.createElement("g",{transform:"translate(3.0, 29.0)",fill:"#000000"},o.createElement("ellipse",{opacity:"0.04",cx:"10.5",cy:"5.80029008",rx:"10.5",ry:"5.25002273"}),o.createElement("ellipse",{opacity:"0.04",cx:"10.5",cy:"5.80029008",rx:"10.5",ry:"5.25002273"}),o.createElement("ellipse",{opacity:"0.04",cx:"10.5",cy:"5.80029008",rx:"9.5",ry:"4.77275007"}),o.createElement("ellipse",{opacity:"0.04",cx:"10.5",cy:"5.80029008",rx:"8.5",ry:"4.29549936"}),o.createElement("ellipse",{opacity:"0.04",cx:"10.5",cy:"5.80029008",rx:"7.5",ry:"3.81822308"}),o.createElement("ellipse",{opacity:"0.04",cx:"10.5",cy:"5.80029008",rx:"6.5",ry:"3.34094679"}),o.createElement("ellipse",{opacity:"0.04",cx:"10.5",cy:"5.80029008",rx:"5.5",ry:"2.86367051"}),o.createElement("ellipse",{opacity:"0.04",cx:"10.5",cy:"5.80029008",rx:"4.5",ry:"2.38636864"})),o.createElement("g",{fill:"#3FB1CE"},o.createElement("path",{d:"M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"})),o.createElement("g",{opacity:"0.25",fill:"#000000"},o.createElement("path",{d:"M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"})),o.createElement("g",{transform:"translate(6.0, 7.0)",fill:"#FFFFFF"}),o.createElement("g",{transform:"translate(8.0, 8.0)"},o.createElement("circle",{fill:"#000000",opacity:"0.25",cx:"5.5",cy:"5.5",r:"5.4999962"}),o.createElement("circle",{fill:"#FFFFFF",cx:"5.5",cy:"5.5",r:"5.4999962"}))))},W=n(74),I=n.n(W),D=n(27),A=n(225),T=n.n(A),z=n(441),U=function(){var e=Object(z.a)(T.a.mark((function e(t){var n,o,a;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Math.round(5*t.lat)/5,o=Math.round(5*t.lng)/5,a='\n    [out:json];\n    (node["amenity"="drinking_water"](around:'.concat(t.around,",").concat(n,",").concat(o,"););\n    out;>;out;\n  "),e.abrupt("return",fetch("https://overpass-api.de/api/interpreter?data=".concat(a,"&output&cache-only=true")).then((function(e){return e.json()})).then((function(e){return e.elements})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=function(e){return o.createElement("svg",{id:"Layer_1",enableBackground:"new 0 0 512 512",height:"20px",viewBox:"0 0 512 512",width:"20px",fill:e.color||"#393939"},o.createElement("g",null,o.createElement("path",{d:"m421.082 355.479c-16.269-24.198-32.288-43.872-32.962-44.698-2.849-3.49-7.115-5.514-11.62-5.514s-8.771 2.024-11.62 5.514c-.674.826-16.693 20.5-32.962 44.698-34.685 51.594-34.685 70.908-34.685 77.255 0 43.708 35.559 79.267 79.267 79.267s79.267-35.559 79.267-79.267c0-6.347 0-25.662-34.685-77.255z"}),o.createElement("path",{d:"m71.233 64.267h224.934c8.284 0 15-6.716 15-15v-34.267c0-8.284-6.716-15-15-15h-224.934c-8.284 0-15 6.716-15 15v34.267c0 8.284 6.716 15 15 15z"}),o.createElement("path",{d:"m56.233 159.6v64.267c0 8.284 6.716 15 15 15h19.267v-94.267h-19.267c-8.284 0-15 6.716-15 15z"}),o.createElement("path",{d:"m329.366 256c0 8.284 6.716 15 15 15h64.268c8.284 0 15-6.716 15-15v-32.133c0-43.708-35.56-79.267-79.268-79.267h-67.466v94.267h52.466z"}),o.createElement("path",{d:"m231.9 128.533h-1.067v-34.266h-94.267v34.267h-1.066c-8.284 0-15 6.716-15 15v96.4c0 8.284 6.716 15 15 15h96.4c8.284 0 15-6.716 15-15v-96.4c0-8.285-6.715-15.001-15-15.001z"})))},F=(n(899),n(900),n(190)),H=I()(),_={closeButton:!1,closeOnClick:!1,offset:[0,-40],anchor:"bottom"},V=function(e,t,n){return e.geometry.coordinates.reduce((function(e,o){var a=n.project(new F.LngLat(t.lng,t.lat)),r=n.project(new F.LngLat(o[0],o[1])),i=Math.sqrt(Math.pow(Math.abs(a.x-r.x),2)+Math.pow(Math.abs(a.y-r.y),2));return i<e?i:e}),1/0)},G=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).map=d.none,e.popupSelectedRoute=new F.Popup(_),e.popupHoveredRoute=new F.Popup(_),e.positionWatch=d.none,e.drinkingWaterNodes={},e.drinkingWaterMarkers=[],e.updateDrinkingWater=N()((function(){e.props.showDrinkingWater&&e.map.map((function(t){U({around:2e4,lat:t.getCenter().lat,lng:t.getCenter().lng}).then(e.addWaterMarkers)}))}),1e3),e.addWaterMarkers=function(t){e.map.map((function(n){t.forEach((function(t){if(!e.drinkingWaterNodes[t.id]){var a=document.createElement("div");r.render(o.createElement(B,null),a);var i=new F.Marker({element:a}).setLngLat([t.lon,t.lat]);i.addTo(n),e.drinkingWaterNodes[t.id]=t,e.drinkingWaterMarkers.push(i)}}))}))},e.onMouseMove=N()((function(t){e.map.map((function(n){var o=e.props.routes.reduce((function(e,o){var a=V(o,t.lngLat,n);return a<e.distance?{distance:a,route:o}:e}),{distance:1/0});o.distance<25?e.props.onRouteHover&&e.props.onRouteHover(Object(d.some)(o.route)):e.props.hoveredRoute.map((function(){e.props.onRouteHover&&e.props.onRouteHover(d.none)}))}))}),100),e}return Object(s.a)(n,[{key:"initializeMap",value:function(){var e=this;F.accessToken="pk.eyJ1IjoiZnJhbmNlc2NvY2lvcmlhIiwiYSI6ImNqcThyejR6ODA2ZDk0M25rZzZjcGo4ZmcifQ.yRWHQbG1dJjDp43d01bBOw";var t=new F.Map({container:"map",style:"mapbox://styles/francescocioria/cjqi3u6lmame92rmw6aw3uyhm?optimize=true",center:{lat:parseFloat(localStorage.getItem("start_lat")||"45.46"),lng:parseFloat(localStorage.getItem("start_lng")||"9.19")},zoom:11,scrollZoom:!1});t.on("load",(function(){e.map=Object(d.some)(t),e.addLayers(),e.addMarkers(),"firstRoute"===e.props.startPosition&&e.props.routes.length>0&&e.flyToRoute(e.props.routes[0],{animate:!1,padding:80})})),H.isDesktop&&t.on("mousemove",this.onMouseMove),t.on("move",this.updateDrinkingWater),this.props.innerRef&&this.props.innerRef(t)}},{key:"getRouteColor",value:function(e){return this.props.selectedRoute.isSome()&&e===this.props.selectedRoute.value||this.props.hoveredRoute.isSome()&&e===this.props.hoveredRoute.value||this.props.navigating?"#387ddf":e.properties.color}},{key:"addLayers",value:function(){var e=this;this.map.map((function(t){e.props.routes.forEach((function(n){var o={id:n.properties.url,type:"line",source:{type:"geojson",data:n},layout:{"line-join":"round","line-cap":"round"},paint:{"line-width":3,"line-color":e.getRouteColor(n)}};t.on("click",o.id,(function(){e.props.onRouteSelect&&e.props.onRouteSelect(n)})),t.addLayer(o)}))}))}},{key:"addMarkers",value:function(){var e=this;this.map.map((function(t){e.props.routes.forEach((function(n){var a=n.geometry.coordinates[0],i=document.createElement("div");r.render(o.createElement(P,{onClick:function(){return e.props.onRouteSelect&&e.props.onRouteSelect(n)}}),i),new F.Marker({element:i}).setLngLat([a[0],a[1]]).addTo(t)}))}))}},{key:"updateLayers",value:function(){var e=this;this.map.map((function(t){e.props.routes.forEach((function(n){t.setPaintProperty(n.id,"line-color",e.getRouteColor(n))}))}))}},{key:"flyToRoute",value:function(e,t){this.map.map((function(n){var o=e.geometry.coordinates.map((function(e){return new F.LngLatBounds(e,e)})).reduce((function(e,t){return e.extend(t)}));n.fitBounds(o,Object(m.a)({padding:50},t))}))}},{key:"showPopup",value:function(e,t){this.map.map((function(n){var a=new F.LngLat(e.geometry.coordinates[0][0],e.geometry.coordinates[0][1]);t.setLngLat(a).setHTML(x.renderToString(o.createElement(M,{route:e}))).addTo(n)}))}},{key:"updateSelectedRoutePopup",value:function(){this.props.selectedRoute.isSome()?this.showPopup(this.props.selectedRoute.value,this.popupSelectedRoute):this.popupSelectedRoute.remove()}},{key:"updateHoveredRoutePopup",value:function(){var e=this.props.hoveredRoute;e.isSome()&&e.value!==this.props.selectedRoute.fold(null,D.identity)?this.showPopup(e.value,this.popupHoveredRoute):this.popupHoveredRoute.remove()}},{key:"componentDidMount",value:function(){this.initializeMap()}},{key:"componentDidUpdate",value:function(e){var t=this;this.updateLayers(),this.updateSelectedRoutePopup(),this.updateHoveredRoutePopup(),this.props.selectedRoute.isSome()&&(e.selectedRoute.isNone()||e.selectedRoute.value!==this.props.selectedRoute.value)&&this.flyToRoute(this.props.selectedRoute.value),this.props.showDrinkingWater||(this.drinkingWaterMarkers.forEach((function(e){e.remove()})),this.drinkingWaterMarkers=[],this.drinkingWaterNodes={}),requestAnimationFrame((function(){return t.map.map((function(e){return e.resize()}))}))}},{key:"render",value:function(){return o.createElement(L,{grow:!0,id:"map"})}}]),n}(o.PureComponent),Q=n(57),Z=n.n(Q),q=n(442),J=n.n(q),K=n(226),$=n(222),X=n.n($);K.b.global.animation=0;var Y=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(c.a)(this,n);for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).interval=d.none,e}return Object(s.a)(n,[{key:"render",value:function(){var e=this,t=Math.round(this.props.route.properties.length/10)||1,n=this.props.route.properties.distances,a=X()(n.map((function(e){return function(e,t){var n=e%t,o=t/2,a=Math.round(e-n);return n<o?a:a+t}(e,t)}))),r=this.props.route.geometry.coordinates.map((function(e){return e[2]?Math.round(e[2]):null}));return o.createElement(K.a,{datasetKeyProvider:function(e){return e.datasetKeyProvider},data:{datasets:[{label:"Elevation",pointRadius:0,borderWidth:0,yAxisID:"y-axis",xAxisID:"x-axis-hidden",data:r,datasetKeyProvider:"elevation"},{xAxisID:"x-axis",data:[],datasetKeyProvider:"ticks"},{yAxisID:"y-axis",data:r.map((function(t,n){return n===e.props.activeRoutePointIndex?t:null})),backgroundColor:"#5bb3e0",datasetKeyProvider:"userLocation"}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{xAxes:[{id:"x-axis-hidden",type:"category",labels:n.map((function(e){return e.toFixed(1)})),display:!1},{id:"x-axis",labels:a,ticks:{callback:function(t){return t<=e.props.route.properties.length?"".concat(t," km"):null}}}],yAxes:[{type:"linear",id:"y-axis",ticks:{precision:0,maxRotation:0,stepSize:50,suggestedMin:.7*this.props.route.properties.minElevation,suggestedMax:300,ticks:{callback:function(e){return"".concat(e," m")}}}}]},tooltips:{mode:"index",intersect:!1,callbacks:{title:function(e){return"Dist:  ".concat(e[0].label," km")},label:function(){return""},footer:function(e,t){return"Elev: ".concat(e[0].value," m")}}}},legend:null,height:50})}}]),n}(o.Component),ee=n(444),te=(n(922),n(190)),ne=new J.a,oe=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).map=d.none,e.userLocationMarker=d.none,e.positionWatch=d.none,e.positionWatchCheckInterval=d.none,e.compassIcon=o.createRef(),e.interacting=!1,e.previousClosestRoutePoint=d.none,e.state={position:d.none,deviceBearing:d.none,showElevationProfile:!1,showDrinkingWater:!1,geoLocationState:"userLocation"===e.props.startPosition?"NorthTracking":"Off"},e.startWatchingPosition=function(){e.positionWatch=Object(d.some)(navigator.geolocation.watchPosition((function(t){localStorage.setItem("start_lat",String(t.coords.latitude)),localStorage.setItem("start_lng",String(t.coords.longitude)),e.setState({position:Object(d.some)(t)})}),(function(){}),{enableHighAccuracy:!0})),e.positionWatchCheckInterval=Object(d.some)(window.setInterval((function(){e.state.position.map((function(t){Date.now()-t.timestamp>6e4&&(e.stopWatchingPosition(),e.startWatchingPosition())}))}),3e4))},e.stopWatchingPosition=function(){e.positionWatch.map((function(e){return navigator.geolocation.clearWatch(e)})),e.positionWatchCheckInterval.map((function(e){window.clearInterval(e)}))},e.startWatchingDeviceOrientation=function(){window.addEventListener("deviceorientationabsolute",e.onDeviceOrientation,!0)},e.stopWatchingDeviceOrientation=function(){window.removeEventListener("deviceorientationabsolute",e.onDeviceOrientation,!0)},e.onVisibilityChange=function(){document.hidden?(e.stopWatchingDeviceOrientation(),e.stopWatchingPosition()):(e.startWatchingDeviceOrientation(),"Off"!==e.state.geoLocationState&&e.startWatchingPosition())},e.getCoordinatesSubset=function(e){var t=window.innerWidth*window.devicePixelRatio/5;return e.filter((function(n,o){return o%Math.max(1,Math.round(e.length/t))===0}))},e.getClosestRoutePoint=function(){return e.interacting?e.previousClosestRoutePoint:e.state.position.chain((function(t){return e.props.navigatingRoute.chain((function(n){var o=e.getCoordinatesSubset(n.geometry.coordinates).reduce((function(e,n,o){var a=n[1],r=n[0],i=new ee.a(a,"meters").distance([a,r],[t.coords.latitude,t.coords.longitude]);return i<200&&i<e.distance?{distance:i,index:o,coordinates:n}:e}),{distance:1/0,index:-1});return e.previousClosestRoutePoint=o.index>=0?Object(d.some)(o):d.none,e.previousClosestRoutePoint}))}))},e.updateInnerRef=function(t){e.props.innerRef&&e.props.innerRef(t),e.map.isNone()&&(e.map=Object(d.some)(t),e.props.scale&&t.addControl(new te.ScaleControl),t.on("touchstart",(function(){e.interacting=!0})),t.on("touchend",(function(){e.interacting=!1})),t.on("dragstart",(function(){"NorthTracking"===e.state.geoLocationState?e.setState({geoLocationState:"North"}):"CompassTracking"===e.state.geoLocationState&&e.setState({geoLocationState:"Compass"})})),t.on("dragend",(function(){e.props.onSortRoutes&&e.props.onSortRoutes()})))},e.rotateUserLocationDot=function(){e.map.map((function(t){e.state.deviceBearing.map((function(n){Object(d.fromNullable)(document.getElementById("userLocationDotWrapper")).map((function(o){var a="CompassTracking"===e.state.geoLocationState?0:n-t.getBearing(),r="rotate(".concat(a,"deg)");o.style.transform=r}))}))}))},e.updateUserLocationDotMarker=function(){e.map.map((function(t){e.state.position.map((function(n){var a={lng:n.coords.longitude,lat:n.coords.latitude};if("Off"!==e.state.geoLocationState&&e.userLocationMarker.isNone()){var i=document.createElement("div");i.className="userLocationDotMarker",r.render(o.createElement(L,{column:!0,id:"userLocationDotWrapper"},o.createElement(L,{shrink:!1,className:"triangle"}),o.createElement(L,{shrink:!1,className:"userLocationDot"})),i);var c=new te.Marker({element:i}).setLngLat(a);c.addTo(t),e.userLocationMarker=Object(d.some)(c)}else"Off"!==e.state.geoLocationState&&e.userLocationMarker.isSome()?e.userLocationMarker.value.setLngLat(a):"Off"===e.state.geoLocationState&&e.userLocationMarker.isSome()&&(e.userLocationMarker.value.remove(),e.userLocationMarker=d.none)}))}))},e.centerOnUserLocation=function(t){e.map.map((function(n){e.state.position.map((function(o){n.flyTo(Object(m.a)({duration:1e3,center:{lng:o.coords.longitude,lat:o.coords.latitude},essential:!0},t)),t.animate&&(e.interacting=!0,setTimeout((function(){return e.interacting=!1}),1005))}))}))},e.onNorthTrackingClick=function(){"NorthTracking"!==e.state.geoLocationState?e.setState({geoLocationState:"NorthTracking"}):"NorthTracking"===e.state.geoLocationState&&e.setState({geoLocationState:"Off"})},e.onCompassTrackingClick=function(){"CompassTracking"!==e.state.geoLocationState?e.setState({geoLocationState:"CompassTracking"}):"CompassTracking"===e.state.geoLocationState&&e.setState({geoLocationState:"Off"})},e.onDeviceOrientation=N()((function(t){e.setState({deviceBearing:Object(d.fromNullable)(t.alpha).chain((function(n){return Object(d.fromNullable)(t.beta).chain((function(o){return Object(d.fromNullable)(t.gamma).map((function(t){return e.compassHeading(n,o,t)}))}))}))},e.rotateUserLocationDot)}),16),e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){this.props.noSleep&&ne.enable(),this.startWatchingDeviceOrientation(),"Off"!==this.state.geoLocationState&&this.startWatchingPosition(),document.addEventListener("visibilitychange",this.onVisibilityChange)}},{key:"componentWillUnmount",value:function(){this.props.noSleep&&ne.disable(),this.stopWatchingDeviceOrientation(),this.stopWatchingPosition(),document.removeEventListener("visibilitychange",this.onVisibilityChange)}},{key:"compassHeading",value:function(e,t,n){var o=e*(Math.PI/180),a=t*(Math.PI/180),r=n*(Math.PI/180),i=Math.cos(o),c=Math.sin(o),s=Math.sin(a),l=Math.cos(r),u=Math.sin(r),p=-i*u-c*s*l,m=-c*u+i*s*l,d=Math.atan(p/m);return m<0?d+=Math.PI:p<0&&(d+=2*Math.PI),d*=180/Math.PI,d}},{key:"componentDidUpdate",value:function(e,t){"Off"===t.geoLocationState&&"Off"!==this.state.geoLocationState&&this.startWatchingPosition(),"Off"!==t.geoLocationState&&"Off"===this.state.geoLocationState&&this.stopWatchingPosition(),this.updateUserLocationDotMarker(),this.interacting||"NorthTracking"!==this.state.geoLocationState||this.centerOnUserLocation({bearing:0,animate:"NorthTracking"!==t.geoLocationState}),this.interacting||"CompassTracking"!==this.state.geoLocationState||this.centerOnUserLocation({bearing:this.state.deviceBearing.fold(0,D.identity),animate:"CompassTracking"!==t.geoLocationState})}},{key:"render",value:function(){var e=this,t=Math.round(this.state.position.fold(0,(function(e){return e.coords.speed?e.coords.speed/1e3*3600:0}))),n=Math.round(this.state.position.fold(0,(function(e){return e.coords.altitude||0}))),a=this.state.showElevationProfile&&this.props.navigatingRoute.isSome();return o.createElement(L,{className:Z()("mapWithControls",{showElevationProfile:a,showScale:this.props.scale}),height:"100%",grow:!0,column:!0},o.createElement(L,{className:"info-wrapper"},this.props.speedometer&&o.createElement(L,{className:"speed-wrapper control-button",column:!0,vAlignContent:"center",hAlignContent:"center"},t,o.createElement("span",{className:"unit"},"km/h")),this.props.altimeter&&o.createElement(L,{className:"altitude-wrapper control-button",column:!0,vAlignContent:"center",hAlignContent:"center"},n,o.createElement("span",{className:"unit"},"msl"))),o.createElement(L,{column:!0,className:"controls-wrapper"},this.props.altitudeControl&&o.createElement(L,{className:"toggle-elevation control-button",onClick:function(){e.setState({showElevationProfile:!e.state.showElevationProfile})},hAlignContent:"center",vAlignContent:"center",style:{background:this.state.showElevationProfile?"#f8f8f8":void 0}},o.createElement("svg",{width:"29",height:"29",viewBox:"0 0 15 15"},o.createElement("path",{id:"path5571",d:"M7.5,2C7.2,2,7.1,2.2,6.9,2.4 l-5.8,9.5C1,12,1,12.2,1,12.3C1,12.8,1.4,13,1.7,13h11.6c0.4,0,0.7-0.2,0.7-0.7c0-0.2,0-0.2-0.1-0.4L8.2,2.4C8,2.2,7.8,2,7.5,2z M7.5,3.5L10.8,9H10L8.5,7.5L7.5,9l-1-1.5L5,9H4.1L7.5,3.5z",fill:this.state.showElevationProfile?"#5bb3e0":"#393939"}))),this.props.drinkingWaterControl&&o.createElement(L,{className:"toggle-drinking-water control-button",onClick:function(){e.setState({showDrinkingWater:!e.state.showDrinkingWater})},hAlignContent:"center",vAlignContent:"center",style:{background:this.state.showDrinkingWater?"#f8f8f8":void 0}},o.createElement(B,{color:this.state.showDrinkingWater?"#5bb3e0":"#393939"}))),this.props.geoLocateControl&&o.createElement(L,{className:"tracking-controls"},o.createElement(L,{className:"geo-locate control-button",vAlignContent:"center",hAlignContent:"center",onClick:this.onNorthTrackingClick,style:{background:"NorthTracking"===this.state.geoLocationState?"#f8f8f8":void 0}},"North"===this.state.geoLocationState?o.createElement("svg",{width:"25px",height:"25px",viewBox:"0 0 511.48 511.48",fill:"#5bb3e0"},o.createElement("path",{d:"M287.74,287.48c-8.832,0-16,7.168-16,16v60.224l-33.696-67.392c-0.352-0.704-0.96-1.152-1.376-1.76    c-0.672-0.96-1.28-1.952-2.176-2.752c-0.736-0.672-1.568-1.088-2.368-1.6c-0.928-0.576-1.792-1.216-2.816-1.6    c-0.992-0.384-2.016-0.448-3.072-0.608c-0.832-0.16-1.6-0.512-2.496-0.512c-0.192,0-0.352,0.096-0.544,0.096    c-0.992,0.032-1.92,0.384-2.912,0.608c-1.12,0.256-2.208,0.384-3.232,0.864c-0.16,0.064-0.32,0.032-0.48,0.128    c-0.704,0.352-1.152,0.96-1.792,1.408c-0.96,0.672-1.92,1.28-2.72,2.112c-0.704,0.768-1.152,1.632-1.664,2.496    c-0.544,0.864-1.152,1.696-1.536,2.688c-0.384,1.056-0.48,2.144-0.64,3.264c-0.128,0.8-0.48,1.504-0.48,2.336v128    c0,8.832,7.168,16,16,16c8.832,0,16-7.168,16-16v-60.224l33.696,67.36c0.16,0.32,0.512,0.448,0.704,0.768    c1.152,1.952,2.656,3.584,4.512,4.896c0.544,0.384,1.024,0.768,1.632,1.088c2.24,1.248,4.704,2.112,7.456,2.112    c2.432,0,4.672-0.608,6.72-1.568c0.128-0.064,0.288-0.032,0.448-0.096c0.704-0.352,1.152-0.96,1.792-1.408    c0.96-0.672,1.92-1.28,2.72-2.112c0.704-0.736,1.152-1.632,1.664-2.496c0.544-0.896,1.152-1.696,1.536-2.688    c0.384-1.056,0.48-2.176,0.672-3.264c0.096-0.832,0.448-1.536,0.448-2.368v-128C303.74,294.648,296.572,287.48,287.74,287.48z"}),o.createElement("path",{d:"M255.74,223.48c-79.392,0-144,64.608-144,144s64.608,144,144,144s144-64.608,144-144S335.132,223.48,255.74,223.48z     M255.74,479.48c-61.76,0-112-50.24-112-112s50.24-112,112-112s112,50.24,112,112S317.5,479.48,255.74,479.48z"}),o.createElement("path",{d:"M397.084,216.088L269.404,7.128c-5.824-9.504-21.504-9.504-27.328,0l-127.68,208.96    c-4.16,6.784-2.656,15.616,3.456,20.704c6.208,5.056,15.104,4.832,21.024-0.544c31.552-28.864,73.056-44.768,116.864-44.768    s85.312,15.904,116.864,44.768c3.072,2.784,6.944,4.192,10.816,4.192c3.584,0,7.232-1.216,10.176-3.648    C399.74,231.704,401.244,222.872,397.084,216.088z M255.74,159.48c-27.36,0-54.016,5.28-78.592,15.296L255.74,46.168    l78.592,128.608C309.756,164.76,283.1,159.48,255.74,159.48z"})):o.createElement("svg",{width:"25px",height:"25px",viewBox:"0 0 512 512",fill:"NorthTracking"===this.state.geoLocationState?"#5bb3e0":"#393939"},o.createElement("path",{d:"M397.344,216.64L269.664,7.68C266.752,2.912,261.568,0,256,0s-10.752,2.912-13.664,7.648l-127.68,208.96 c-4.16,6.784-2.656,15.616,3.488,20.704c6.112,5.024,15.072,4.832,20.96-0.544C170.688,207.904,212.224,192,256,192 s85.312,15.904,116.896,44.768c5.856,5.344,14.784,5.568,20.96,0.544C400,232.224,401.504,223.392,397.344,216.64z"}),o.createElement("path",{d:"M256,224c-79.392,0-144,64.608-144,144s64.608,144,144,144s144-64.608,144-144S335.392,224,256,224z M304,432 c0,7.392-5.088,13.888-12.32,15.552c-1.248,0.32-2.464,0.448-3.68,0.448c-5.984,0-11.552-3.328-14.304-8.832L240,371.776V432 c0,8.832-7.168,16-16,16c-8.832,0-16-7.168-16-16V304c0-7.392,5.12-13.888,12.32-15.552c7.136-1.856,14.656,1.792,17.984,8.416 L272,364.224V304c0-8.832,7.168-16,16-16c8.832,0,16,7.168,16,16V432z"}))),o.createElement(L,{className:"compass-reset control-button",vAlignContent:"center",hAlignContent:"center",onClick:this.onCompassTrackingClick,style:{paddingTop:5,paddingRight:8,background:"NorthTracking"===this.state.geoLocationState?"#f8f8f8":void 0}},"Compass"===this.state.geoLocationState?o.createElement("svg",{height:"25",viewBox:"0 0 64 64",width:"25",fill:"#5bb3e0"},o.createElement("path",{d:"m32 28c-2.206 0-4 1.794-4 4s1.794 4 4 4 4-1.794 4-4-1.794-4-4-4zm0 6c-1.103 0-2-.897-2-2s.897-2 2-2 2 .897 2 2-.897 2-2 2z"}),o.createElement("path",{d:"m39.433 29.308-6.543-12.764c-.342-.668-1.438-.668-1.779 0l-6.543 12.764c-.016.03-.03.061-.042.093-.888 2.274-.648 4.782.657 6.88 1.325 2.128 3.533 3.473 6.06 3.688.249.02.502.031.757.031s.508-.011.76-.032c2.525-.215 4.733-1.56 6.058-3.688 1.306-2.098 1.545-4.605.657-6.88-.012-.032-.026-.062-.042-.092zm-2.313 5.915c-.989 1.588-2.64 2.592-4.528 2.753-.391.031-.796.031-1.183 0-1.89-.161-3.541-1.165-4.53-2.753-.96-1.542-1.145-3.381-.509-5.05l5.63-10.981 5.629 10.98c.636 1.67.451 3.509-.509 5.051z"}),o.createElement("path",{d:"m63 32c0-17.094-13.907-31-31-31s-31 13.906-31 31 13.907 31 31 31c4.451 0 8.736-.931 12.751-2.748 1.938 1.705 4.471 2.748 7.249 2.748 6.065 0 11-4.935 11-11 0-2.778-1.043-5.311-2.748-7.249 1.817-4.015 2.748-8.298 2.748-12.751zm-60 0c0-15.99 13.009-29 29-29s29 13.01 29 29c0 3.935-.775 7.729-2.291 11.302-1.055-.816-2.257-1.448-3.566-1.839 1.231-3 1.857-6.177 1.857-9.463 0-13.785-11.215-25-25-25s-25 11.215-25 25 11.215 25 25 25c3.286 0 6.462-.626 9.463-1.856.391 1.308 1.023 2.51 1.838 3.565-3.573 1.516-7.367 2.291-11.301 2.291-15.991 0-29-13.01-29-29zm38 20c0 .384.021.764.059 1.138-2.559 1.1-5.262 1.717-8.059 1.835v-2.973h-2v2.975c-11.888-.512-21.463-10.087-21.975-21.975h3.975v-2h-3.975c.512-11.888 10.087-21.463 21.975-21.975v3.975h2v-3.975c11.888.512 21.463 10.087 21.975 21.975h-3.975v2h3.973c-.118 2.797-.735 5.5-1.835 8.059-.374-.038-.754-.059-1.138-.059-6.065 0-11 4.935-11 11zm11 9c-4.962 0-9-4.037-9-9s4.038-9 9-9 9 4.037 9 9-4.038 9-9 9z"}),o.createElement("path",{d:"m54 53-4.2-5.6c-.258-.345-.708-.486-1.116-.349-.409.137-.684.518-.684.949v9h2v-6l4.2 5.6c.192.257.491.4.8.4.105 0 .212-.017.316-.052.409-.136.684-.517.684-.948v-9h-2z"})):o.createElement("svg",{height:"25",viewBox:"0 0 64 64",width:"25",fill:"CompassTracking"===this.state.geoLocationState?"#5bb3e0":"#393939"},o.createElement("circle",{cx:"32",cy:"32",r:"2"}),o.createElement("path",{d:"m32 19.192-5.629 10.98c-.636 1.669-.451 3.508.509 5.05.989 1.588 2.64 2.592 4.53 2.753.387.031.792.031 1.183 0 1.888-.161 3.539-1.165 4.528-2.753.96-1.542 1.145-3.381.509-5.05zm0 16.808c-2.206 0-4-1.794-4-4s1.794-4 4-4 4 1.794 4 4-1.794 4-4 4z"}),o.createElement("path",{d:"m32 57c-13.785 0-25-11.215-25-25s11.215-25 25-25 25 11.215 25 25c0 3.286-.626 6.463-1.857 9.463 1.308.391 2.51 1.023 3.566 1.839 1.516-3.573 2.291-7.367 2.291-11.302 0-15.99-13.009-29-29-29s-29 13.01-29 29 13.009 29 29 29c3.934 0 7.728-.775 11.302-2.292-.815-1.055-1.447-2.257-1.838-3.565-3.002 1.231-6.178 1.857-9.464 1.857z"}),o.createElement("path",{d:"m54.975 31c-.512-11.888-10.087-21.463-21.975-21.975v3.975h-2v-3.975c-11.888.512-21.463 10.087-21.975 21.975h3.975v2h-3.975c.512 11.888 10.087 21.463 21.975 21.975v-2.975h2v2.973c2.797-.118 5.5-.735 8.059-1.835-.038-.374-.059-.754-.059-1.138 0-6.065 4.935-11 11-11 .384 0 .764.021 1.139.059 1.1-2.559 1.717-5.262 1.835-8.059h-3.974v-2zm-16.157 5.28c-1.325 2.128-3.533 3.473-6.058 3.688-.252.021-.505.032-.76.032s-.508-.011-.758-.032c-2.527-.215-4.735-1.56-6.06-3.688-1.306-2.098-1.545-4.605-.657-6.88.012-.032.026-.062.042-.093l6.543-12.764c.342-.668 1.438-.668 1.779 0l6.543 12.764c.016.03.03.061.042.093.889 2.275.65 4.783-.656 6.88z"}),o.createElement("path",{d:"m52 43c-4.962 0-9 4.037-9 9s4.038 9 9 9 9-4.037 9-9-4.038-9-9-9zm4 13c0 .431-.275.812-.684.948-.104.035-.211.052-.316.052-.309 0-.607-.144-.8-.4l-4.2-5.6v6h-2v-9c0-.431.275-.812.684-.948.408-.138.858.004 1.116.349l4.2 5.599v-6h2z"})))),a&&this.props.navigatingRoute.isSome()&&o.createElement(L,{className:"elevation-profile-wrapper"},o.createElement(Y,{route:this.props.navigatingRoute.value,activeRoutePointIndex:this.getClosestRoutePoint().map((function(e){return e.index})).toUndefined()})),o.createElement(L,{grow:!0},o.createElement(G,{routes:this.props.routes,startPosition:this.props.startPosition,navigating:this.props.navigatingRoute.isSome(),innerRef:this.updateInnerRef,hoveredRoute:this.props.hoveredRoute,selectedRoute:this.props.selectedRoute,onRouteHover:this.props.onRouteHover,onRouteSelect:this.props.onRouteSelect,onSortRoutes:this.props.onSortRoutes,showDrinkingWater:this.state.showDrinkingWater})))}}]),n}(o.Component),ae=n(100),re=n.n(ae),ie=n(64),ce=(n(1103),n(1104),function(e){return o.createElement(L,{className:Z()("route",{"is-selected":e.isSelected}),column:!0,onClick:e.onClick,shrink:!1},o.createElement(L,{className:"name"},e.route.properties.name),o.createElement(L,{className:"distance",vAlignContent:"bottom"},o.createElement("label",null,"Distance")," ",e.route.properties.length," km"),o.createElement(L,{className:"min-elevation",vAlignContent:"bottom"},o.createElement("label",null,"Elev (min)")," ",Math.round(e.route.properties.minElevation)," m"),o.createElement(L,{className:"max-elevation",vAlignContent:"bottom"},o.createElement("label",null,"Elev (max)")," ",Math.round(e.route.properties.maxElevation)," m"),o.createElement(L,{className:"actions"},o.createElement(re.a,{size:"tiny",label:"Details",onClick:e.onDetailsClick})))}),se=Object(ie.declareCommands)({doUpdateLocation:p.doUpdateLocation})(function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){var e=this;return o.createElement(L,{className:"side-bar",column:!0,shrink:!1},o.createElement(L,{column:!0,shrink:!1,className:"navigationGpx"},o.createElement("h2",null,"Navigation (GPX)"),o.createElement("input",{type:"file",accept:".gpx",onChange:function(t){var n=t.target.files[0],o=new FileReader;o.addEventListener("load",(function(t){localStorage.setItem("gpxFile",t.target.result),e.props.doUpdateLocation(h({view:"navigation",routeId:Object(d.some)("gpx")}))})),o.readAsText(n)}})),o.createElement(L,{column:!0,shrink:!1,className:"routes"},o.createElement("h2",null,"Routes"),this.props.routes.map((function(t,n){return o.createElement(ce,{key:n,route:t,onClick:function(){return e.props.onRouteClick(t)},isSelected:e.props.selectedRoute.isSome()&&e.props.selectedRoute.value===t,onDetailsClick:function(n){n.stopPropagation(),e.props.doUpdateLocation(h({view:"details",routeId:Object(d.some)(t.id)}))}})}))))}}]),n}(o.PureComponent)),le=n(221),ue=n.n(le),pe=(n(1105),Object(p.declareQueries)({routes:C})(function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(c.a)(this,n);for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).map=d.none,e.state={selectedRoute:d.none,hoveredRoute:d.none},e.onRouteSelect=function(t){e.setState({selectedRoute:e.state.selectedRoute.isSome()&&e.state.selectedRoute.value===t?d.none:Object(d.some)(t)})},e.onRouteHover=function(t){e.setState({hoveredRoute:t})},e.onSortRoutes=function(){e.forceUpdate()},e.updateInnerRef=function(t){e.map.isNone()&&(e.map=Object(d.some)(t),e.forceUpdate())},e}return Object(s.a)(n,[{key:"render",value:function(){var e=this;return this.props.routes.fold(null,(function(){return null}),(function(t){var n=e.map.fold(t,(function(e){return ue()(t,(function(t){return V(t,e.getCenter(),e)}))}));return o.createElement(L,{className:"explorer",grow:!0},o.createElement(se,{routes:n,onRouteClick:e.onRouteSelect,selectedRoute:e.state.selectedRoute}),o.createElement(oe,{routes:t,selectedRoute:e.state.selectedRoute,hoveredRoute:e.state.hoveredRoute,onRouteHover:e.onRouteHover,onRouteSelect:e.onRouteSelect,onSortRoutes:e.onSortRoutes,innerRef:e.updateInnerRef,startPosition:"userLocation",navigatingRoute:d.none,noSleep:!1,altimeter:!1,altitudeControl:!1,drinkingWaterControl:!1,geoLocateControl:!0,speedometer:!1,scale:!1}))}))}}]),n}(o.Component))),me=n(445),de=n(446),he=n(447),fe=n(148),ge=(n(438),n(1110),n(1125).linkify),ve=n(1111),be=me.a,Ee=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"componentDidMount",value:function(){this.forceUpdate()}},{key:"render",value:function(){var e=this,t=Array.from(document.querySelectorAll(".remarkable img")),n=document.querySelector(".remarkable h1:first-of-type");return o.createElement(L,{className:"markdown",hAlignContent:"center",shrink:!1},o.createElement(L,{className:"wrapper",grow:!0},o.createElement(L,{grow:!0,column:!0,style:{position:"relative"}},o.createElement(L,{className:"title"},null===n||void 0===n?void 0:n.innerText),o.createElement(L,{className:"actions"},o.createElement(re.a,{flat:!0,size:"medium",label:"Enter Navigation",onClick:this.props.onEnterNavigation}),o.createElement(re.a,{flat:!0,size:"medium",label:"Download GPX",onClick:function(){return function(e){var t=new Blob([ve(e)],{type:"text/plain;charset=utf-8"});Object(de.saveAs)(t,"".concat(e.properties.name,".gpx"))}(e.props.route)}})),o.createElement("div",{className:"remarkable",dangerouslySetInnerHTML:{__html:ke.render(this.props.routeReadme)}}),o.createElement(L,{className:"summary"},o.createElement(L,{className:"distance",column:!0,shrink:!1},o.createElement("span",null,this.props.route.properties.length," km"),o.createElement("label",null,"Distance")),o.createElement(L,{className:"min-elevation",column:!0,shrink:!1},o.createElement("span",null,Math.round(this.props.route.properties.minElevation)," m"),o.createElement("label",null,"Min elevation")),o.createElement(L,{className:"max-elevation",column:!0,shrink:!1},o.createElement("span",null,Math.round(this.props.route.properties.maxElevation)," m"),o.createElement("label",null,"Max elevation")))),o.createElement(L,{className:"images",hAlignContent:"right",shrink:!1},o.createElement(he.Carousel,{showThumbs:!1,showStatus:!1,showIndicators:t.length>1,infiniteLoop:!0,autoPlay:!0,interval:6e3},t.map((function(e){return o.createElement("img",{key:e.src,src:e.src,alt:e.src})})))),o.createElement(L,{className:"mobile-images",grow:!0},t.slice(0,2).map((function(e){return o.createElement("img",{key:e.src,src:e.src,alt:e.src})})))))}}]),n}(o.PureComponent),ke=(new be).use(ge),ye=Object(p.declareQueries)({route:R,routeReadme:S}),we=Object(ie.declareCommands)({doUpdateLocation:p.doUpdateLocation})(ye(function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(c.a)(this,n);for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).getRoutes=Object(fe.a)((function(e){return[e]}),(function(e,t){return e[0].id===t[0].id})),e}return Object(s.a)(n,[{key:"render",value:function(){var e=this;return this.props.route.fold(null,(function(){return null}),(function(t){return e.props.routeReadme.fold(null,(function(){return null}),(function(n){return t.isNone()||n.isNone()?null:o.createElement(L,{className:"details",height:"100%",grow:!0,column:!0},o.createElement(Ee,{routeReadme:n.value,route:t.value,onEnterNavigation:function(){e.props.doUpdateLocation(h({view:"navigation",routeId:Object(d.some)(t.value.id)}))}}),o.createElement(L,{shrink:!1,className:"map-wrapper"},o.createElement(oe,{routes:e.getRoutes(t.value),startPosition:"firstRoute",navigatingRoute:d.none,hoveredRoute:t,selectedRoute:d.none,altimeter:!1,altitudeControl:!1,drinkingWaterControl:!1,geoLocateControl:!0,noSleep:!1,speedometer:!1,scale:!1})),o.createElement(L,{className:"elevation-profile-wrapper",shrink:!1},o.createElement(Y,{route:t.value})))}))}))}}]),n}(o.Component))),Ce=I()(),Re=Object(p.declareQueries)({route:R}),Se=Object(ie.declareCommands)({doUpdateLocation:p.doUpdateLocation})(Re(function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(c.a)(this,n);for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).getRoutes=Object(fe.a)((function(e){return[e]}),(function(e,t){return e[0].id===t[0].id})),e}return Object(s.a)(n,[{key:"render",value:function(){var e=this;return this.props.route.fold(null,(function(){return null}),(function(t){return t.isNone()?null:o.createElement(L,{className:"navigation",height:"100%",grow:!0,column:!0},o.createElement(oe,{routes:e.getRoutes(t.value),navigatingRoute:t,altimeter:!Ce.isDesktop,altitudeControl:!0,drinkingWaterControl:!0,noSleep:!0,scale:!0,speedometer:!Ce.isDesktop,geoLocateControl:!0,startPosition:"firstRoute",hoveredRoute:d.none,selectedRoute:d.none}))}))}}]),n}(o.Component))),Oe=n(101),Le=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function xe(e){if(console.log(e),"serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");Le?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var o=n.headers.get("content-type");404===n.status||null!=o&&-1===o.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):je(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):je(t,e)}))}}function je(e,t){navigator.serviceWorker.register(e,{scope:"/fontanelle/"}).then((function(e){e.onupdatefound=function(){console.log("onupdatefound!");var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var Ne=function(){var e=a.a.useState(!1),t=Object(Oe.a)(e,2),n=t[0],r=t[1],i=a.a.useState(d.none),c=Object(Oe.a)(i,2),s=c[0],l=c[1],u=function(e){r(!0),l(Object(d.fromNullable)(e.waiting))};Object(o.useEffect)((function(){xe({onUpdate:u})}),[]);return n?a.a.createElement(L,{className:"updateAvailable",vAlignContent:"center",hAlignContent:"center",style:{background:"lightgreen",height:25,color:"black"}},"Update Available",a.a.createElement("span",{style:{marginLeft:60,textDecoration:"underline",cursor:"pointer"},onClick:function(){return console.log("reload page"),s.map((function(e){return e.postMessage({type:"SKIP_WAITING"})})),r(!1),void window.location.reload(!0)}},"Install"),a.a.createElement("span",{style:{marginLeft:20,textDecoration:"underline",cursor:"pointer"},onClick:function(){console.log("ignore"),r(!1)}},"Ignore")):null},Me=n(190);Me.workerClass=n(1113).default,Me.prewarm();var Pe=Object(p.declareQueries)({currentView:y})(function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){return this.props.currentView.fold(null,(function(){return null}),(function(e){return o.createElement(L,{className:"app",height:"100%",column:!0},o.createElement(Ne,null),"explorer"===e.view&&o.createElement(pe,null),"details"===e.view&&o.createElement(we,null),"navigation"===e.view&&o.createElement(Se,null))}))}}]),n}(o.Component)),We=I()(),Ie=Z()({"is-desktop":We.isDesktop,"is-tablet":We.isTablet,"is-phone":We.isPhone}),De=document.documentElement||document.body;De.className=Z()(De.className,Ie);n(1114),n(1121),n(1123),n(1124);i.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(Pe,null)),document.getElementById("app"))},887:function(e,t){},895:function(e,t,n){},900:function(e,t,n){},922:function(e,t,n){}},[[1126,1,2]]]);
//# sourceMappingURL=main.ecf4be9e.chunk.js.map
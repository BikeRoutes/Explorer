(this.webpackJsonpexplorer=this.webpackJsonpexplorer||[]).push([[0],{1073:function(e,t,n){},1075:function(e,t,n){},1080:function(e,t,n){},1092:function(e,t,n){},1093:function(e,t,n){},1095:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o),a=n(53),i=n.n(a),c=n(11),s=n(9),l=n(16),u=n(17),p=n(13),m=n(36),d=n(2);function h(e){switch(e.view){case"details":return{pathname:"/Explorer",search:{view:"details",routeId:e.routeId.getOrElse("")}};case"navigation":return{pathname:"/Explorer",search:{view:"navigation",routeId:e.routeId.getOrElse("")}};case"explorer":return{pathname:"/Explorer",search:{}}}}var f=n(220),g=n(221),v=function(e){return(t=e,Object(d.fromNullable)(/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t)).map((function(e){return{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}}))).fold(!1,(function(e){var t=[e.r/255,e.g/255,e.b/255].map((function(e){return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)})),n=.2126*t[0]+.7152*t[1]+.0722*t[2];return n<=.5&&n>=.1}));var t},b=function(e){return function e(t,n){var o="".concat(t,"$");return v(n)?n:e(o,g(o))}(e,g(e))},E=n(871);var y=Object(p.Query)({params:{},dependencies:{location:p.location},fetch:function(e){var t=e.location;return Promise.resolve(function(e){switch(e.search.view){case"details":return{view:"details",routeId:Object(d.fromNullable)(e.search.routeId)};case"navigation":return{view:"navigation",routeId:Object(d.fromNullable)(e.search.routeId)};default:return{view:"explorer"}}}(t))}}),k=function(e){var t,n=e.geometry.coordinates.reduce((function(e,t){return t[2]&&t[2]<e?t[2]:e}),Number.MAX_SAFE_INTEGER),o=e.geometry.coordinates.reduce((function(e,t){return t[2]&&t[2]>e?t[2]:e}),Number.MIN_SAFE_INTEGER),r=e.geometry.coordinates.map((function(t,n){return f({type:"LineString",coordinates:e.geometry.coordinates.slice(0,n+1)})/1e3}));return Object(m.a)({id:e.properties.url},e,{properties:Object(m.a)({},e.properties,{color:"gpx"!==e.properties.url?b(e.properties.name):"#38ffcc",length:Math.round(f(e.geometry)/100)/10,elevationGain:Math.round((t=e.geometry.coordinates,t.filter((function(e){return e[2]})).reduce((function(e,n,o){var r=o>0?t[o-1][2]:void 0,a=n[2];return r&&a>r?e+a-r:e}),0))),minElevation:n,maxElevation:o,distances:r})})},w=Object(p.Query)({cacheStrategy:p.available,params:{},fetch:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){return fetch("https://or52hotxz1.execute-api.us-east-1.amazonaws.com/dev/").then((function(e){return e.json()})).then((function(e){return JSON.parse(e.body)})).then((function(e){return e.map(k)}))}))}),R=Object(p.Query)({params:{},dependencies:{currentView:y,routes:w},fetch:function(e){var t=e.currentView,n=e.routes;if(("details"===t.view||"navigation"===t.view)&&t.routeId.isSome()){var o=t.routeId.value;if("gpx"===o){var r=new DOMParser;return Promise.resolve(Object(d.fromNullable)(localStorage.getItem("gpxFile")).map((function(e){var t=E.gpx(r.parseFromString(e,"text/xml")).features.filter((function(e){return"LineString"===e.geometry.type})).reduce((function(e,t){return Object(m.a)({},e,{geometry:Object(m.a)({},e.geometry,{coordinates:e.geometry.coordinates.concat(t.geometry.coordinates)})})}));return k(Object(m.a)({},t,{properties:Object(m.a)({},t.properties,{url:"gpx"})}))})))}return Promise.resolve(Object(d.fromNullable)(n.find((function(e){return e.id===o}))))}return Promise.resolve(d.none)}}),S=Object(p.Query)({params:{},dependencies:{route:R},fetch:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var t=e.route;if(t.isSome()){var n=/BikeRoutes.+master\/(.+)\/.+$/.exec(t.value.properties.url),o="https://raw.githubusercontent.com/BikeRoutes/BikeRoutes/master/".concat(n[1],"/README.md");return fetch(o).then((function(e){return e.text()})).then((function(e){return Object(d.some)(e)}))}return Promise.resolve(d.none)}))}),C=n(425),x=n.n(C).a,O=n(426),L=n(145),j=n.n(L),N=n(22),M=n.n(N),A=(n(880),function(e){return o.createElement(x,{className:"popup",column:!0},o.createElement(x,{className:"name"},e.route.properties.name),o.createElement(x,{className:"distance",vAlignContent:"bottom"},o.createElement("label",null,"Distance")," ",e.route.properties.length," km"),o.createElement(x,{className:"elevation",vAlignContent:"bottom"},o.createElement("label",null,"Elevation")," ",e.route.properties.elevationGain," m"))}),P=function(e){return o.createElement("svg",{height:"41px",width:"27px",viewBox:"0 0 27 41",onClick:e.onClick,className:"marker",style:{cursor:"pointer",marginTop:"-100%"}},o.createElement("g",{fillRule:"nonzero"},o.createElement("g",{transform:"translate(3.0, 29.0)",fill:"#000000"},o.createElement("ellipse",{opacity:"0.04",cx:"10.5",cy:"5.80029008",rx:"10.5",ry:"5.25002273"}),o.createElement("ellipse",{opacity:"0.04",cx:"10.5",cy:"5.80029008",rx:"10.5",ry:"5.25002273"}),o.createElement("ellipse",{opacity:"0.04",cx:"10.5",cy:"5.80029008",rx:"9.5",ry:"4.77275007"}),o.createElement("ellipse",{opacity:"0.04",cx:"10.5",cy:"5.80029008",rx:"8.5",ry:"4.29549936"}),o.createElement("ellipse",{opacity:"0.04",cx:"10.5",cy:"5.80029008",rx:"7.5",ry:"3.81822308"}),o.createElement("ellipse",{opacity:"0.04",cx:"10.5",cy:"5.80029008",rx:"6.5",ry:"3.34094679"}),o.createElement("ellipse",{opacity:"0.04",cx:"10.5",cy:"5.80029008",rx:"5.5",ry:"2.86367051"}),o.createElement("ellipse",{opacity:"0.04",cx:"10.5",cy:"5.80029008",rx:"4.5",ry:"2.38636864"})),o.createElement("g",{fill:"#3FB1CE"},o.createElement("path",{d:"M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"})),o.createElement("g",{opacity:"0.25",fill:"#000000"},o.createElement("path",{d:"M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"})),o.createElement("g",{transform:"translate(6.0, 7.0)",fill:"#FFFFFF"}),o.createElement("g",{transform:"translate(8.0, 8.0)"},o.createElement("circle",{fill:"#000000",opacity:"0.25",cx:"5.5",cy:"5.5",r:"5.4999962"}),o.createElement("circle",{fill:"#FFFFFF",cx:"5.5",cy:"5.5",r:"5.4999962"}))))},I=n(75),T=n.n(I),D=n(27),U=(n(883),n(884),T()()),F={closeButton:!1,closeOnClick:!1,offset:[0,-40],anchor:"bottom"},H=function(e,t,n){return e.geometry.coordinates.reduce((function(e,o){var r=n.project(new M.a.LngLat(t.lng,t.lat)),a=n.project(new M.a.LngLat(o[0],o[1])),i=Math.sqrt(Math.pow(Math.abs(r.x-a.x),2)+Math.pow(Math.abs(r.y-a.y),2));return i<e?i:e}),1/0)},z=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).map=d.none,e.popupSelectedRoute=new M.a.Popup(F),e.popupHoveredRoute=new M.a.Popup(F),e.positionWatch=d.none,e.onMouseMove=j()((function(t){e.map.map((function(n){var o=e.props.routes.reduce((function(e,o){var r=H(o,t.lngLat,n);return r<e.distance?{distance:r,route:o}:e}),{distance:1/0});o.distance<25?e.props.onRouteHover&&e.props.onRouteHover(Object(d.some)(o.route)):e.props.hoveredRoute.map((function(){e.props.onRouteHover&&e.props.onRouteHover(d.none)}))}))}),100),e}return Object(s.a)(n,[{key:"initializeMap",value:function(){var e=this;M.a.accessToken="pk.eyJ1IjoiZnJhbmNlc2NvY2lvcmlhIiwiYSI6ImNqcThyejR6ODA2ZDk0M25rZzZjcGo4ZmcifQ.yRWHQbG1dJjDp43d01bBOw";var t=new M.a.Map({container:"map",style:"mapbox://styles/francescocioria/cjqi3u6lmame92rmw6aw3uyhm?optimize=true",center:{lat:parseFloat(localStorage.getItem("start_lat")||"45.46"),lng:parseFloat(localStorage.getItem("start_lng")||"9.19")},zoom:11,scrollZoom:!1});t.on("load",(function(){e.map=Object(d.some)(t),e.addLayers(),e.addMarkers(),"firstRoute"===e.props.startPosition&&e.props.routes.length>0&&e.flyToRoute(e.props.routes[0],{animate:!1,padding:80})})),U.isDesktop&&t.on("mousemove",this.onMouseMove),this.props.innerRef&&this.props.innerRef(t)}},{key:"getRouteColor",value:function(e){return this.props.selectedRoute.isSome()&&e===this.props.selectedRoute.value||this.props.hoveredRoute.isSome()&&e===this.props.hoveredRoute.value||this.props.navigating?"#387ddf":e.properties.color}},{key:"addLayers",value:function(){var e=this;this.map.map((function(t){e.props.routes.forEach((function(n){var o={id:n.properties.url,type:"line",source:{type:"geojson",data:n},layout:{"line-join":"round","line-cap":"round"},paint:{"line-width":3,"line-color":e.getRouteColor(n)}};t.on("click",o.id,(function(){e.props.onRouteSelect&&e.props.onRouteSelect(n)})),t.addLayer(o)}))}))}},{key:"addMarkers",value:function(){var e=this;this.map.map((function(t){e.props.routes.forEach((function(n){var r=n.geometry.coordinates[0],i=document.createElement("div");a.render(o.createElement(P,{onClick:function(){return e.props.onRouteSelect&&e.props.onRouteSelect(n)}}),i),new M.a.Marker({element:i}).setLngLat([r[0],r[1]]).addTo(t)}))}))}},{key:"updateLayers",value:function(){var e=this;this.map.map((function(t){e.props.routes.forEach((function(n){t.setPaintProperty(n.id,"line-color",e.getRouteColor(n))}))}))}},{key:"flyToRoute",value:function(e,t){this.map.map((function(n){var o=e.geometry.coordinates.map((function(e){return new M.a.LngLatBounds(e,e)})).reduce((function(e,t){return e.extend(t)}));n.fitBounds(o,Object(m.a)({padding:50},t))}))}},{key:"showPopup",value:function(e,t){this.map.map((function(n){var r=new M.a.LngLat(e.geometry.coordinates[0][0],e.geometry.coordinates[0][1]);t.setLngLat(r).setHTML(O.renderToString(o.createElement(A,{route:e}))).addTo(n)}))}},{key:"updateSelectedRoutePopup",value:function(){this.props.selectedRoute.isSome()?this.showPopup(this.props.selectedRoute.value,this.popupSelectedRoute):this.popupSelectedRoute.remove()}},{key:"updateHoveredRoutePopup",value:function(){var e=this.props.hoveredRoute;e.isSome()&&e.value!==this.props.selectedRoute.fold(null,D.identity)?this.showPopup(e.value,this.popupHoveredRoute):this.popupHoveredRoute.remove()}},{key:"componentDidMount",value:function(){this.initializeMap()}},{key:"componentDidUpdate",value:function(e){var t=this;this.updateLayers(),this.updateSelectedRoutePopup(),this.updateHoveredRoutePopup(),this.props.selectedRoute.isSome()&&(e.selectedRoute.isNone()||e.selectedRoute.value!==this.props.selectedRoute.value)&&this.flyToRoute(this.props.selectedRoute.value),setTimeout((function(){return t.map.map((function(e){return e.resize()}))}),30)}},{key:"render",value:function(){return o.createElement(x,{grow:!0,id:"map"})}}]),n}(o.PureComponent),B=n(58),W=n.n(B),_=n(427),G=n.n(_),Q=n(222),Z=n(219),J=n.n(Z);Q.b.global.animation=0;var K=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).interval=d.none,e}return Object(s.a)(n,[{key:"render",value:function(){var e=this,t=Math.round(this.props.route.properties.length/10)||1,n=this.props.route.properties.distances,r=J()(n.map((function(e){return function(e,t){var n=e%t,o=t/2,r=Math.round(e-n);return n<o?r:r+t}(e,t)}))),a=this.props.route.geometry.coordinates.map((function(e){return e[2]?Math.round(e[2]):null}));return o.createElement(Q.a,{datasetKeyProvider:function(e){return e.datasetKeyProvider},data:{datasets:[{label:"Elevation",pointRadius:0,borderWidth:0,yAxisID:"y-axis",xAxisID:"x-axis-hidden",data:a,datasetKeyProvider:"elevation"},{xAxisID:"x-axis",data:[],datasetKeyProvider:"ticks"},{yAxisID:"y-axis",data:a.map((function(t,n){return n===e.props.activeRoutePointIndex?t:null})),backgroundColor:"#5bb3e0",datasetKeyProvider:"userLocation"}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{xAxes:[{id:"x-axis-hidden",type:"category",labels:n.map((function(e){return e.toFixed(1)})),display:!1},{id:"x-axis",labels:r,ticks:{callback:function(t){return t<=e.props.route.properties.length?"".concat(t," km"):null}}}],yAxes:[{type:"linear",id:"y-axis",ticks:{precision:0,maxRotation:0,stepSize:50,suggestedMin:.7*this.props.route.properties.minElevation,suggestedMax:300,ticks:{callback:function(e){return"".concat(e," m")}}}}]},tooltips:{mode:"index",intersect:!1,callbacks:{title:function(e){return"Dist:  ".concat(e[0].label," km")},label:function(){return""},footer:function(e,t){return"Elev: ".concat(e[0].value," m")}}}},legend:null,height:50})}}]),n}(o.Component),V=n(429),q=(n(892),new G.a),$=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).map=d.none,e.positionWatch=d.none,e.compassIcon=o.createRef(),e.interacting=!1,e.userLocationMarker=d.none,e.state={position:d.none,deviceBearing:d.none,showElevationProfile:!1,geoLocationState:"Off"},e.getCoordinatesSubset=function(e){var t=window.innerWidth*window.devicePixelRatio/5;return e.filter((function(n,o){return o%Math.max(1,Math.round(e.length/t))===0}))},e.getClosestRoutePoint=function(t){return e.props.navigatingRoute.map((function(n){return e.getCoordinatesSubset(n.geometry.coordinates).reduce((function(e,n,o){var r=n[1],a=n[0],i=new V.a(r,"meters").distance([r,a],[t.coords.latitude,t.coords.longitude]);return i<200&&i<e.distance?{distance:i,index:o,coordinates:n}:e}),{distance:1/0,index:-1})}))},e.updateInnerRef=function(t){e.props.innerRef&&e.props.innerRef(t),e.map.isNone()&&(e.map=Object(d.some)(t),e.props.scale&&t.addControl(new M.a.ScaleControl),t.on("touchstart",(function(){e.interacting=!0})),t.on("touchend",(function(){e.interacting=!1})),t.on("dragstart",(function(){"NorthTracking"===e.state.geoLocationState?e.setState({geoLocationState:"North"}):"CompassTracking"===e.state.geoLocationState&&e.setState({geoLocationState:"Compass"})})),t.on("dragend",(function(){e.props.onSortRoutes&&e.props.onSortRoutes()})))},e.rotateUserLocationDot=function(){e.map.map((function(t){e.state.deviceBearing.map((function(n){Object(d.fromNullable)(document.getElementById("userLocationDotWrapper")).map((function(o){var r="CompassTracking"===e.state.geoLocationState?0:n-t.getBearing(),a="rotate(".concat(r,"deg)");o.style.transform=a}))}))}))},e.updateUserLocationDotMarker=function(){e.map.map((function(t){e.state.position.map((function(n){var r={lng:n.coords.longitude,lat:n.coords.latitude};if("Off"!==e.state.geoLocationState&&e.userLocationMarker.isNone()){var i=document.createElement("div");i.className="userLocationDotMarker",a.render(o.createElement(x,{column:!0,id:"userLocationDotWrapper"},o.createElement(x,{shrink:!1,className:"triangle"}),o.createElement(x,{shrink:!1,className:"userLocationDot"})),i);var c=new M.a.Marker({element:i}).setLngLat(r);c.addTo(t),e.userLocationMarker=Object(d.some)(c)}else"Off"!==e.state.geoLocationState&&e.userLocationMarker.isSome()?e.userLocationMarker.value.setLngLat(r):"Off"===e.state.geoLocationState&&e.userLocationMarker.isSome()&&(e.userLocationMarker.value.remove(),e.userLocationMarker=d.none)}))}))},e.centerOnUserLocation=function(t){e.map.map((function(n){e.state.position.map((function(o){n.flyTo(Object(m.a)({duration:1e3,center:{lng:o.coords.longitude,lat:o.coords.latitude},essential:!0},t)),t.animate&&(e.interacting=!0,setTimeout((function(){return e.interacting=!1}),1005))}))}))},e.onNorthTrackingClick=function(){"NorthTracking"!==e.state.geoLocationState?e.setState({geoLocationState:"NorthTracking"}):"NorthTracking"===e.state.geoLocationState&&e.setState({geoLocationState:"Off"})},e.onCompassTrackingClick=function(){"CompassTracking"!==e.state.geoLocationState?e.setState({geoLocationState:"CompassTracking"}):"CompassTracking"===e.state.geoLocationState&&e.setState({geoLocationState:"Off"})},e.onDeviceOrientation=j()((function(t){e.setState({deviceBearing:Object(d.fromNullable)(t.alpha).map((function(e){return-e}))},e.rotateUserLocationDot)}),16),e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.props.noSleep&&q.enable(),this.positionWatch=Object(d.some)(navigator.geolocation.watchPosition((function(t){localStorage.setItem("start_lat",String(t.coords.latitude)),localStorage.setItem("start_lng",String(t.coords.longitude)),e.setState({position:Object(d.some)(t)})}),(function(){}),{enableHighAccuracy:!0})),this.props.navigatingRoute.isSome()&&window.addEventListener("deviceorientationabsolute",this.onDeviceOrientation,!0),"userLocation"===this.props.startPosition&&this.setState({geoLocationState:"NorthTracking"})}},{key:"componentWillUnmount",value:function(){this.props.noSleep&&q.disable(),this.positionWatch.map((function(e){return navigator.geolocation.clearWatch(e)})),window.removeEventListener("deviceorientationabsolute",this.onDeviceOrientation,!0)}},{key:"componentDidUpdate",value:function(e,t){this.updateUserLocationDotMarker(),this.interacting||"NorthTracking"!==this.state.geoLocationState||this.centerOnUserLocation({bearing:0,animate:"NorthTracking"!==t.geoLocationState}),this.interacting||"CompassTracking"!==this.state.geoLocationState||this.centerOnUserLocation({bearing:this.state.deviceBearing.fold(0,D.identity),animate:"CompassTracking"!==t.geoLocationState})}},{key:"render",value:function(){var e=this,t=Math.round(this.state.position.fold(0,(function(e){return e.coords.speed?e.coords.speed/1e3*3600:0}))),n=Math.round(this.state.position.fold(0,(function(e){return e.coords.altitude||0}))),r=this.state.showElevationProfile&&this.props.navigatingRoute.isSome();return o.createElement(x,{className:W()("mapWithControls",{showElevationProfile:r,showScale:this.props.scale}),height:"100%",grow:!0,column:!0},o.createElement(x,{className:"info-wrapper"},this.props.speedometer&&o.createElement(x,{className:"speed-wrapper control-button",column:!0,vAlignContent:"center",hAlignContent:"center"},t,o.createElement("span",{className:"unit"},"km/h")),this.props.altimeter&&o.createElement(x,{className:"altitude-wrapper control-button",column:!0,vAlignContent:"center",hAlignContent:"center"},n,o.createElement("span",{className:"unit"},"msl"))),o.createElement(x,{column:!0,className:"controls-wrapper"},this.props.altitudeControl&&o.createElement(x,{className:"toggle-elevation control-button",onClick:function(){e.setState({showElevationProfile:!e.state.showElevationProfile})},hAlignContent:"center",vAlignContent:"center"},o.createElement("svg",{width:"29",height:"29",viewBox:"0 0 15 15"},o.createElement("path",{id:"path5571",d:"M7.5,2C7.2,2,7.1,2.2,6.9,2.4 l-5.8,9.5C1,12,1,12.2,1,12.3C1,12.8,1.4,13,1.7,13h11.6c0.4,0,0.7-0.2,0.7-0.7c0-0.2,0-0.2-0.1-0.4L8.2,2.4C8,2.2,7.8,2,7.5,2z M7.5,3.5L10.8,9H10L8.5,7.5L7.5,9l-1-1.5L5,9H4.1L7.5,3.5z",fill:this.state.showElevationProfile?"#5bb3e0":"#393939"})))),this.props.geoLocateControl&&o.createElement(x,{className:"tracking-controls"},o.createElement(x,{className:"geo-locate control-button",vAlignContent:"center",hAlignContent:"center",onClick:this.onNorthTrackingClick},"North"===this.state.geoLocationState?o.createElement("svg",{width:"29",height:"29",viewBox:"0 0 20 20",fill:"#5bb3e0"},o.createElement("path",{d:"M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z"})):o.createElement("svg",{width:"29",height:"29",viewBox:"0 0 20 20",fill:"NorthTracking"===this.state.geoLocationState?"#5bb3e0":"#393939"},o.createElement("path",{d:"M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z"}),o.createElement("circle",{cx:"10",cy:"10",r:"2"}))),o.createElement(x,{className:"compass-reset control-button",vAlignContent:"center",hAlignContent:"center",onClick:this.onCompassTrackingClick},o.createElement("svg",{width:"29",height:"29",xmlns:"http://www.w3.org/2000/svg",fill:"#333333",ref:this.compassIcon},o.createElement("path",{d:"M10.5 14l4-8 4 8h-8z"}),o.createElement("path",{d:"M10.5 16l4 8 4-8h-8z",fill:"#e1e1e1"})))),r&&this.props.navigatingRoute.isSome()&&o.createElement(x,{className:"elevation-profile-wrapper"},o.createElement(K,{route:this.props.navigatingRoute.value,activeRoutePointIndex:this.interacting?void 0:this.state.position.chain((function(t){return e.getClosestRoutePoint(t).map((function(e){return e.index}))})).toUndefined()})),o.createElement(x,{grow:!0},o.createElement(z,{routes:this.props.routes,startPosition:this.props.startPosition,navigating:this.props.navigatingRoute.isSome(),innerRef:this.updateInnerRef,hoveredRoute:this.props.hoveredRoute,selectedRoute:this.props.selectedRoute,onRouteHover:this.props.onRouteHover,onRouteSelect:this.props.onRouteSelect,onSortRoutes:this.props.onSortRoutes})))}}]),n}(o.Component),X=n(100),Y=n.n(X),ee=n(65),te=(n(1073),n(1074),function(e){return o.createElement(x,{className:W()("route",{"is-selected":e.isSelected}),column:!0,onClick:e.onClick,shrink:!1},o.createElement(x,{className:"name"},e.route.properties.name),o.createElement(x,{className:"distance",vAlignContent:"bottom"},o.createElement("label",null,"Distance")," ",e.route.properties.length," km"),o.createElement(x,{className:"min-elevation",vAlignContent:"bottom"},o.createElement("label",null,"Elev (min)")," ",Math.round(e.route.properties.minElevation)," m"),o.createElement(x,{className:"max-elevation",vAlignContent:"bottom"},o.createElement("label",null,"Elev (max)")," ",Math.round(e.route.properties.maxElevation)," m"),o.createElement(x,{className:"actions"},o.createElement(Y.a,{size:"tiny",label:"Details",onClick:e.onDetailsClick})))}),ne=Object(ee.declareCommands)({doUpdateLocation:p.doUpdateLocation})(function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){var e=this;return o.createElement(x,{className:"side-bar",column:!0,shrink:!1},o.createElement(x,{column:!0,shrink:!1,className:"navigationGpx"},o.createElement("h2",null,"Navigation (GPX)"),o.createElement("input",{type:"file",accept:".gpx",onChange:function(t){var n=t.target.files[0],o=new FileReader;o.addEventListener("load",(function(t){localStorage.setItem("gpxFile",t.target.result),e.props.doUpdateLocation(h({view:"navigation",routeId:Object(d.some)("gpx")}))})),o.readAsText(n)}})),o.createElement(x,{column:!0,shrink:!1,className:"routes"},o.createElement("h2",null,"Routes"),this.props.routes.map((function(t,n){return o.createElement(te,{key:n,route:t,onClick:function(){return e.props.onRouteClick(t)},isSelected:e.props.selectedRoute.isSome()&&e.props.selectedRoute.value===t,onDetailsClick:function(n){n.stopPropagation(),e.props.doUpdateLocation(h({view:"details",routeId:Object(d.some)(t.id)}))}})}))))}}]),n}(o.PureComponent)),oe=n(218),re=n.n(oe),ae=(n(1075),Object(p.declareQueries)({routes:w})(function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).map=d.none,e.state={selectedRoute:d.none,hoveredRoute:d.none},e.onRouteSelect=function(t){e.setState({selectedRoute:e.state.selectedRoute.isSome()&&e.state.selectedRoute.value===t?d.none:Object(d.some)(t)})},e.onRouteHover=function(t){e.setState({hoveredRoute:t})},e.onSortRoutes=function(){e.forceUpdate()},e.updateInnerRef=function(t){e.map.isNone()&&(e.map=Object(d.some)(t),e.forceUpdate())},e}return Object(s.a)(n,[{key:"render",value:function(){var e=this;return this.props.routes.fold(null,(function(){return null}),(function(t){var n=e.map.fold(t,(function(e){return re()(t,(function(t){return H(t,e.getCenter(),e)}))}));return o.createElement(x,{className:"explorer",grow:!0},o.createElement(ne,{routes:n,onRouteClick:e.onRouteSelect,selectedRoute:e.state.selectedRoute}),o.createElement($,{routes:t,selectedRoute:e.state.selectedRoute,hoveredRoute:e.state.hoveredRoute,onRouteHover:e.onRouteHover,onRouteSelect:e.onRouteSelect,onSortRoutes:e.onSortRoutes,innerRef:e.updateInnerRef,startPosition:"userLocation",navigatingRoute:d.none,noSleep:!1,altimeter:!1,altitudeControl:!1,geoLocateControl:!0,speedometer:!1,scale:!1}))}))}}]),n}(o.Component))),ie=n(430),ce=n(431),se=n(432),le=n(146),ue=(n(424),n(1080),n(1094).linkify),pe=n(1081),me=ie.a,de=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"componentDidMount",value:function(){this.forceUpdate()}},{key:"render",value:function(){var e=this,t=Array.from(document.querySelectorAll(".remarkable img")),n=document.querySelector(".remarkable h1:first-of-type");return o.createElement(x,{className:"markdown",hAlignContent:"center",shrink:!1},o.createElement(x,{className:"wrapper",grow:!0},o.createElement(x,{grow:!0,column:!0,style:{position:"relative"}},o.createElement(x,{className:"title"},null===n||void 0===n?void 0:n.innerText),o.createElement(x,{className:"actions"},o.createElement(Y.a,{flat:!0,size:"medium",label:"Enter Navigation",onClick:this.props.onEnterNavigation}),o.createElement(Y.a,{flat:!0,size:"medium",label:"Download GPX",onClick:function(){return function(e){var t=new Blob([pe(e)],{type:"text/plain;charset=utf-8"});Object(ce.saveAs)(t,"".concat(e.properties.name,".gpx"))}(e.props.route)}})),o.createElement("div",{className:"remarkable",dangerouslySetInnerHTML:{__html:he.render(this.props.routeReadme)}}),o.createElement(x,{className:"summary"},o.createElement(x,{className:"distance",column:!0,shrink:!1},o.createElement("span",null,this.props.route.properties.length," km"),o.createElement("label",null,"Distance")),o.createElement(x,{className:"min-elevation",column:!0,shrink:!1},o.createElement("span",null,Math.round(this.props.route.properties.minElevation)," m"),o.createElement("label",null,"Min elevation")),o.createElement(x,{className:"max-elevation",column:!0,shrink:!1},o.createElement("span",null,Math.round(this.props.route.properties.maxElevation)," m"),o.createElement("label",null,"Max elevation")))),o.createElement(x,{className:"images",hAlignContent:"right",shrink:!1},o.createElement(se.Carousel,{showThumbs:!1,showStatus:!1,showIndicators:t.length>1,infiniteLoop:!0,autoPlay:!0,interval:6e3},t.map((function(e){return o.createElement("img",{key:e.src,src:e.src,alt:e.src})})))),o.createElement(x,{className:"mobile-images",grow:!0},t.slice(0,2).map((function(e){return o.createElement("img",{key:e.src,src:e.src,alt:e.src})})))))}}]),n}(o.PureComponent),he=(new me).use(ue),fe=Object(p.declareQueries)({route:R,routeReadme:S}),ge=Object(ee.declareCommands)({doUpdateLocation:p.doUpdateLocation})(fe(function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).getRoutes=Object(le.a)((function(e){return[e]}),(function(e,t){return e[0].id===t[0].id})),e}return Object(s.a)(n,[{key:"render",value:function(){var e=this;return this.props.route.fold(null,(function(){return null}),(function(t){return e.props.routeReadme.fold(null,(function(){return null}),(function(n){return t.isNone()||n.isNone()?null:o.createElement(x,{className:"details",height:"100%",grow:!0,column:!0},o.createElement(de,{routeReadme:n.value,route:t.value,onEnterNavigation:function(){e.props.doUpdateLocation(h({view:"navigation",routeId:Object(d.some)(t.value.id)}))}}),o.createElement(x,{shrink:!1,className:"map-wrapper"},o.createElement($,{routes:e.getRoutes(t.value),startPosition:"firstRoute",navigatingRoute:d.none,hoveredRoute:t,selectedRoute:d.none,altimeter:!1,altitudeControl:!1,geoLocateControl:!0,noSleep:!1,speedometer:!1,scale:!1})),o.createElement(x,{className:"elevation-profile-wrapper",shrink:!1},o.createElement(K,{route:t.value})))}))}))}}]),n}(o.Component))),ve=T()(),be=Object(p.declareQueries)({route:R}),Ee=Object(ee.declareCommands)({doUpdateLocation:p.doUpdateLocation})(be(function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).getRoutes=Object(le.a)((function(e){return[e]}),(function(e,t){return e[0].id===t[0].id})),e}return Object(s.a)(n,[{key:"render",value:function(){var e=this;return this.props.route.fold(null,(function(){return null}),(function(t){return t.isNone()?null:o.createElement(x,{className:"navigation",height:"100%",grow:!0,column:!0},o.createElement($,{routes:e.getRoutes(t.value),navigatingRoute:t,altimeter:!ve.isDesktop,altitudeControl:!0,noSleep:!0,scale:!0,speedometer:!ve.isDesktop,geoLocateControl:!0,startPosition:"firstRoute",hoveredRoute:d.none,selectedRoute:d.none}))}))}}]),n}(o.Component))),ye=n(101),ke=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function we(e){if("serviceWorker"in navigator){if(new URL("/Explorer",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/Explorer","/service-worker.js");ke?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var o=n.headers.get("content-type");404===n.status||null!=o&&-1===o.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Re(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):Re(t,e)}))}}function Re(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var Se=function(){var e=r.a.useState(!1),t=Object(ye.a)(e,2),n=t[0],a=t[1],i=r.a.useState(d.none),c=Object(ye.a)(i,2),s=c[0],l=c[1],u=function(e){a(!0),l(Object(d.fromNullable)(e.waiting))};Object(o.useEffect)((function(){we({onUpdate:u})}),[]);return n?r.a.createElement(x,{className:"updateAvailable",vAlignContent:"center",hAlignContent:"center",style:{background:"lightgreen",height:25,color:"black"}},"Update Available",r.a.createElement("span",{style:{marginLeft:60,textDecoration:"underline",cursor:"pointer"},onClick:function(){return console.log("reload page"),s.map((function(e){return e.postMessage({type:"SKIP_WAITING"})})),a(!1),void window.location.reload(!0)}},"Install"),r.a.createElement("span",{style:{marginLeft:20,textDecoration:"underline",cursor:"pointer"},onClick:function(){console.log("ignore"),a(!1)}},"Ignore")):null};M.a.prewarm();var Ce=Object(p.declareQueries)({currentView:y})(function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){return this.props.currentView.fold(null,(function(){return null}),(function(e){return o.createElement(x,{className:"app",height:"100%",column:!0},o.createElement(Se,null),"explorer"===e.view&&o.createElement(ae,null),"details"===e.view&&o.createElement(ge,null),"navigation"===e.view&&o.createElement(Ee,null))}))}}]),n}(o.Component)),xe=T()(),Oe=W()({"is-desktop":xe.isDesktop,"is-tablet":xe.isTablet,"is-phone":xe.isPhone}),Le=document.documentElement||document.body;Le.className=W()(Le.className,Oe);n(1083),n(1090),n(1092),n(1093);i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Ce,null)),document.getElementById("app"))},433:function(e,t,n){e.exports=n(1095)},872:function(e,t){},880:function(e,t,n){},884:function(e,t,n){},892:function(e,t,n){}},[[433,1,2]]]);
//# sourceMappingURL=main.908d00d3.chunk.js.map